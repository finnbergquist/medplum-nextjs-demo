{
  "resourceType": "Bundle",
  "type": "transaction",
  "entry": [
    {
      "fullUrl": "urn:uuid:783f9857-5ca0-4dc8-9284-654873eb56c6",
      "request": {
        "method": "POST",
        "url": "Binary"
      },
      "resource": {
        "resourceType": "Binary",
        "contentType": "text/typescript",
        "data": "aW1wb3J0IHsgQm90RXZlbnQsIE1lZHBsdW1DbGllbnQsIHJlc29sdmVJZCB9IGZyb20gJ0BtZWRwbHVtL2NvcmUnOwppbXBvcnQgeyBBcHBvaW50bWVudCB9IGZyb20gJ0BtZWRwbHVtL2ZoaXJ0eXBlcyc7CgpleHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihtZWRwbHVtOiBNZWRwbHVtQ2xpZW50LCBldmVudDogQm90RXZlbnQ8QXBwb2ludG1lbnQ+KTogUHJvbWlzZTxBcHBvaW50bWVudD4gewogIGxldCBhcHBvaW50bWVudCA9IGV2ZW50LmlucHV0OwoKICAvLyBCYXNpYyBkYXRhIHZhbGlkYXRpb24KICBjb25zdCBzbG90SWQgPSByZXNvbHZlSWQoYXBwb2ludG1lbnQuc2xvdD8uWzBdKTsKICBpZiAoIXNsb3RJZCkgewogICAgdGhyb3cgbmV3IEVycm9yKCdNdXN0IHByb3ZpZGUgYSBzbG90Jyk7CiAgfQoKICBpZiAoIWFwcG9pbnRtZW50LmFwcG9pbnRtZW50VHlwZSkgewogICAgdGhyb3cgbmV3IEVycm9yKCdNdXN0IHByb3ZpZGUgYW4gYXBwb2ludG1lbnQgdHlwZScpOwogIH0KCiAgaWYgKCFhcHBvaW50bWVudC5zZXJ2aWNlVHlwZSB8fCBhcHBvaW50bWVudC5zZXJ2aWNlVHlwZT8ubGVuZ3RoID09PSAwKSB7CiAgICB0aHJvdyBuZXcgRXJyb3IoJ011c3QgcHJvdmlkZSBhIHNlcnZpY2UgdHlwZScpOwogIH0KCiAgaWYgKGFwcG9pbnRtZW50LnN0YXR1cyAhPT0gJ2Jvb2tlZCcpIHsKICAgIHRocm93IG5ldyBFcnJvcignQXBwb2ludG1lbnQgc3RhdHVzIG11c3QgYmUgImJvb2tlZCInKTsKICB9CgogIGNvbnN0IHNsb3QgPSBhd2FpdCBtZWRwbHVtLnJlYWRSZXNvdXJjZSgnU2xvdCcsIHNsb3RJZCk7CgogIC8vIENyZWF0ZSB0aGUgYXBwb2ludG1lbnQKICBhcHBvaW50bWVudC5zdGFydCA9IHNsb3Quc3RhcnQ7CiAgYXBwb2ludG1lbnQuZW5kID0gc2xvdC5lbmQ7CiAgYXBwb2ludG1lbnQgPSBhd2FpdCBtZWRwbHVtLmNyZWF0ZVJlc291cmNlKGFwcG9pbnRtZW50KTsKCiAgLy8gVXBkYXRlIHRoZSBzbG90IHN0YXR1cyB0byAnYnVzeScKICBzbG90LnN0YXR1cyA9ICdidXN5JzsKICBhd2FpdCBtZWRwbHVtLnVwZGF0ZVJlc291cmNlKHNsb3QpOwoKICByZXR1cm4gYXBwb2ludG1lbnQ7Cn0K"
      }
    },
    {
      "fullUrl": "urn:uuid:4238b745-f887-46b9-a87a-1b46bf66f0ac",
      "request": {
        "method": "POST",
        "url": "Binary"
      },
      "resource": {
        "resourceType": "Binary",
        "contentType": "text/javascript",
        "data": "InVzZSBzdHJpY3QiOwp2YXIgX19kZWZQcm9wID0gT2JqZWN0LmRlZmluZVByb3BlcnR5Owp2YXIgX19nZXRPd25Qcm9wRGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I7CnZhciBfX2dldE93blByb3BOYW1lcyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzOwp2YXIgX19oYXNPd25Qcm9wID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTsKdmFyIF9fZXhwb3J0ID0gKHRhcmdldCwgYWxsKSA9PiB7CiAgZm9yICh2YXIgbmFtZSBpbiBhbGwpCiAgICBfX2RlZlByb3AodGFyZ2V0LCBuYW1lLCB7IGdldDogYWxsW25hbWVdLCBlbnVtZXJhYmxlOiB0cnVlIH0pOwp9Owp2YXIgX19jb3B5UHJvcHMgPSAodG8sIGZyb20sIGV4Y2VwdCwgZGVzYykgPT4gewogIGlmIChmcm9tICYmIHR5cGVvZiBmcm9tID09PSAib2JqZWN0IiB8fCB0eXBlb2YgZnJvbSA9PT0gImZ1bmN0aW9uIikgewogICAgZm9yIChsZXQga2V5IG9mIF9fZ2V0T3duUHJvcE5hbWVzKGZyb20pKQogICAgICBpZiAoIV9faGFzT3duUHJvcC5jYWxsKHRvLCBrZXkpICYmIGtleSAhPT0gZXhjZXB0KQogICAgICAgIF9fZGVmUHJvcCh0bywga2V5LCB7IGdldDogKCkgPT4gZnJvbVtrZXldLCBlbnVtZXJhYmxlOiAhKGRlc2MgPSBfX2dldE93blByb3BEZXNjKGZyb20sIGtleSkpIHx8IGRlc2MuZW51bWVyYWJsZSB9KTsKICB9CiAgcmV0dXJuIHRvOwp9Owp2YXIgX190b0NvbW1vbkpTID0gKG1vZCkgPT4gX19jb3B5UHJvcHMoX19kZWZQcm9wKHt9LCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSksIG1vZCk7CgovLyBzcmMvYm90cy9jb3JlL2Jvb2stYXBwb2ludG1lbnQudHMKdmFyIGJvb2tfYXBwb2ludG1lbnRfZXhwb3J0cyA9IHt9OwpfX2V4cG9ydChib29rX2FwcG9pbnRtZW50X2V4cG9ydHMsIHsKICBoYW5kbGVyOiAoKSA9PiBoYW5kbGVyCn0pOwptb2R1bGUuZXhwb3J0cyA9IF9fdG9Db21tb25KUyhib29rX2FwcG9pbnRtZW50X2V4cG9ydHMpOwp2YXIgaW1wb3J0X2NvcmUgPSByZXF1aXJlKCJAbWVkcGx1bS9jb3JlIik7CmFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIobWVkcGx1bSwgZXZlbnQpIHsKICBsZXQgYXBwb2ludG1lbnQgPSBldmVudC5pbnB1dDsKICBjb25zdCBzbG90SWQgPSAoMCwgaW1wb3J0X2NvcmUucmVzb2x2ZUlkKShhcHBvaW50bWVudC5zbG90Py5bMF0pOwogIGlmICghc2xvdElkKSB7CiAgICB0aHJvdyBuZXcgRXJyb3IoIk11c3QgcHJvdmlkZSBhIHNsb3QiKTsKICB9CiAgaWYgKCFhcHBvaW50bWVudC5hcHBvaW50bWVudFR5cGUpIHsKICAgIHRocm93IG5ldyBFcnJvcigiTXVzdCBwcm92aWRlIGFuIGFwcG9pbnRtZW50IHR5cGUiKTsKICB9CiAgaWYgKCFhcHBvaW50bWVudC5zZXJ2aWNlVHlwZSB8fCBhcHBvaW50bWVudC5zZXJ2aWNlVHlwZT8ubGVuZ3RoID09PSAwKSB7CiAgICB0aHJvdyBuZXcgRXJyb3IoIk11c3QgcHJvdmlkZSBhIHNlcnZpY2UgdHlwZSIpOwogIH0KICBpZiAoYXBwb2ludG1lbnQuc3RhdHVzICE9PSAiYm9va2VkIikgewogICAgdGhyb3cgbmV3IEVycm9yKCdBcHBvaW50bWVudCBzdGF0dXMgbXVzdCBiZSAiYm9va2VkIicpOwogIH0KICBjb25zdCBzbG90ID0gYXdhaXQgbWVkcGx1bS5yZWFkUmVzb3VyY2UoIlNsb3QiLCBzbG90SWQpOwogIGFwcG9pbnRtZW50LnN0YXJ0ID0gc2xvdC5zdGFydDsKICBhcHBvaW50bWVudC5lbmQgPSBzbG90LmVuZDsKICBhcHBvaW50bWVudCA9IGF3YWl0IG1lZHBsdW0uY3JlYXRlUmVzb3VyY2UoYXBwb2ludG1lbnQpOwogIHNsb3Quc3RhdHVzID0gImJ1c3kiOwogIGF3YWl0IG1lZHBsdW0udXBkYXRlUmVzb3VyY2Uoc2xvdCk7CiAgcmV0dXJuIGFwcG9pbnRtZW50Owp9Ci8vIEFubm90YXRlIHRoZSBDb21tb25KUyBleHBvcnQgbmFtZXMgZm9yIEVTTSBpbXBvcnQgaW4gbm9kZToKMCAmJiAobW9kdWxlLmV4cG9ydHMgPSB7CiAgaGFuZGxlcgp9KTsKT2JqZWN0LmFzc2lnbihleHBvcnRzLCBtb2R1bGUuZXhwb3J0cyk7Cg=="
      }
    },
    {
      "request": {
        "method": "PUT",
        "url": "$bot-book-appointment-reference"
      },
      "resource": {
        "resourceType": "Bot",
        "id": "$bot-book-appointment-id",
        "identifier": [
          {
            "system": "http://example.com",
            "value": "book-appointment"
          }
        ],
        "name": "book-appointment",
        "runtimeVersion": "awslambda",
        "sourceCode": {
          "contentType": "text/typescript",
          "url": "urn:uuid:783f9857-5ca0-4dc8-9284-654873eb56c6"
        },
        "executableCode": {
          "contentType": "text/javascript",
          "url": "urn:uuid:4238b745-f887-46b9-a87a-1b46bf66f0ac"
        }
      }
    },
    {
      "fullUrl": "urn:uuid:3ef228e4-d2fc-4caa-ba5a-eb3e8e9ee75c",
      "request": {
        "method": "POST",
        "url": "Binary"
      },
      "resource": {
        "resourceType": "Binary",
        "contentType": "text/typescript",
        "data": "aW1wb3J0IHsgQm90RXZlbnQsIE1lZHBsdW1DbGllbnQsIHJlc29sdmVJZCB9IGZyb20gJ0BtZWRwbHVtL2NvcmUnOwppbXBvcnQgeyBBcHBvaW50bWVudCwgQnVuZGxlLCBCdW5kbGVFbnRyeSwgU2xvdCB9IGZyb20gJ0BtZWRwbHVtL2ZoaXJ0eXBlcyc7CgpleHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihtZWRwbHVtOiBNZWRwbHVtQ2xpZW50LCBldmVudDogQm90RXZlbnQ8QXBwb2ludG1lbnQ+KTogUHJvbWlzZTxCdW5kbGU+IHsKICBjb25zdCBhcHBvaW50bWVudCA9IGV2ZW50LmlucHV0OwoKICAvLyBCYXNpYyBkYXRhIHZhbGlkYXRpb24KICBjb25zdCBzbG90SWQgPSByZXNvbHZlSWQoYXBwb2ludG1lbnQuc2xvdD8uWzBdKTsKICBpZiAoIXNsb3RJZCkgewogICAgdGhyb3cgbmV3IEVycm9yKCdNdXN0IHByb3ZpZGUgYSBzbG90Jyk7CiAgfQoKICBjb25zdCBlbnRyaWVzOiBCdW5kbGVFbnRyeVtdID0gW107CgogIC8vIENoYW5nZSB0aGUgYXBwb2ludG1lbnQgc3RhdHVzIHRvICdjYW5jZWxsZWQnCiAgYXBwb2ludG1lbnQuc3RhdHVzID0gJ2NhbmNlbGxlZCc7CiAgYXBwb2ludG1lbnQuY2FuY2VsYXRpb25SZWFzb24gPSB7CiAgICBjb2Rpbmc6IFsKICAgICAgewogICAgICAgIHN5c3RlbTogJ2h0dHA6Ly90ZXJtaW5vbG9neS5obDcub3JnL0NvZGVTeXN0ZW0vYXBwb2ludG1lbnQtY2FuY2VsbGF0aW9uLXJlYXNvbicsCiAgICAgICAgY29kZTogJ3Byb3YnLAogICAgICAgIGRpc3BsYXk6ICdQcm92aWRlcicsCiAgICAgIH0sCiAgICBdLAogIH07CiAgZW50cmllcy5wdXNoKHsKICAgIHJlcXVlc3Q6IHsKICAgICAgbWV0aG9kOiAnUFVUJywKICAgICAgdXJsOiBgQXBwb2ludG1lbnQ/X2lkPSR7YXBwb2ludG1lbnQuaWR9YCwKICAgIH0sCiAgICByZXNvdXJjZTogYXBwb2ludG1lbnQsCiAgfSk7CgogIC8vIEluc3RlYWQgb2YgdW5saW5raW5nIHRoZSBvcmlnaW5hbCBzbG90LCBjcmVhdGUgYSBuZXcgc2xvdCB3aXRoIHN0YXR1cyAnZnJlZScKICAvLyBzbyBpdCBjYW4gYmUgYm9va2VkIGFnYWluCiAgY29uc3Qgc2xvdCA9IGF3YWl0IG1lZHBsdW0ucmVhZFJlc291cmNlKCdTbG90Jywgc2xvdElkKTsKICBjb25zdCBleGlzdGluZ0ZyZWVTbG90ID0gYXdhaXQgbWVkcGx1bS5zZWFyY2hPbmUoJ1Nsb3QnLCB7CiAgICBzdGFydDogc2xvdC5zdGFydCwKICAgIHN0YXR1czogJ2ZyZWUnLAogIH0pOwogIGlmICghZXhpc3RpbmdGcmVlU2xvdCkgewogICAgY29uc3QgbmV3U2xvdDogU2xvdCA9IHsgLi4uc2xvdCwgaWQ6IHVuZGVmaW5lZCwgc3RhdHVzOiAnZnJlZScgfTsKICAgIGVudHJpZXMucHVzaCh7CiAgICAgIHJlcXVlc3Q6IHsKICAgICAgICBtZXRob2Q6ICdQT1NUJywKICAgICAgICB1cmw6ICdTbG90JywKICAgICAgfSwKICAgICAgcmVzb3VyY2U6IG5ld1Nsb3QsCiAgICB9KTsKICB9CgogIC8vIEV4ZWN1dGUgdGhlIGJhdGNoIHRvIGNyZWF0ZS91cGRhdGUgYWxsIHJlc291cmNlcyBhdCBvbmNlCiAgY29uc3QgcmVzcG9uc2VCdW5kbGUgPSBhd2FpdCBtZWRwbHVtLmV4ZWN1dGVCYXRjaCh7CiAgICByZXNvdXJjZVR5cGU6ICdCdW5kbGUnLAogICAgdHlwZTogJ2JhdGNoJywKICAgIGVudHJ5OiBlbnRyaWVzLAogIH0pOwogIHJldHVybiByZXNwb25zZUJ1bmRsZTsKfQo="
      }
    },
    {
      "fullUrl": "urn:uuid:98c8fe66-a0f0-4ead-a1c4-a75860ffbc25",
      "request": {
        "method": "POST",
        "url": "Binary"
      },
      "resource": {
        "resourceType": "Binary",
        "contentType": "text/javascript",
        "data": "InVzZSBzdHJpY3QiOwp2YXIgX19kZWZQcm9wID0gT2JqZWN0LmRlZmluZVByb3BlcnR5Owp2YXIgX19nZXRPd25Qcm9wRGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I7CnZhciBfX2dldE93blByb3BOYW1lcyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzOwp2YXIgX19oYXNPd25Qcm9wID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTsKdmFyIF9fZXhwb3J0ID0gKHRhcmdldCwgYWxsKSA9PiB7CiAgZm9yICh2YXIgbmFtZSBpbiBhbGwpCiAgICBfX2RlZlByb3AodGFyZ2V0LCBuYW1lLCB7IGdldDogYWxsW25hbWVdLCBlbnVtZXJhYmxlOiB0cnVlIH0pOwp9Owp2YXIgX19jb3B5UHJvcHMgPSAodG8sIGZyb20sIGV4Y2VwdCwgZGVzYykgPT4gewogIGlmIChmcm9tICYmIHR5cGVvZiBmcm9tID09PSAib2JqZWN0IiB8fCB0eXBlb2YgZnJvbSA9PT0gImZ1bmN0aW9uIikgewogICAgZm9yIChsZXQga2V5IG9mIF9fZ2V0T3duUHJvcE5hbWVzKGZyb20pKQogICAgICBpZiAoIV9faGFzT3duUHJvcC5jYWxsKHRvLCBrZXkpICYmIGtleSAhPT0gZXhjZXB0KQogICAgICAgIF9fZGVmUHJvcCh0bywga2V5LCB7IGdldDogKCkgPT4gZnJvbVtrZXldLCBlbnVtZXJhYmxlOiAhKGRlc2MgPSBfX2dldE93blByb3BEZXNjKGZyb20sIGtleSkpIHx8IGRlc2MuZW51bWVyYWJsZSB9KTsKICB9CiAgcmV0dXJuIHRvOwp9Owp2YXIgX190b0NvbW1vbkpTID0gKG1vZCkgPT4gX19jb3B5UHJvcHMoX19kZWZQcm9wKHt9LCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSksIG1vZCk7CgovLyBzcmMvYm90cy9jb3JlL2NhbmNlbC1hcHBvaW50bWVudC50cwp2YXIgY2FuY2VsX2FwcG9pbnRtZW50X2V4cG9ydHMgPSB7fTsKX19leHBvcnQoY2FuY2VsX2FwcG9pbnRtZW50X2V4cG9ydHMsIHsKICBoYW5kbGVyOiAoKSA9PiBoYW5kbGVyCn0pOwptb2R1bGUuZXhwb3J0cyA9IF9fdG9Db21tb25KUyhjYW5jZWxfYXBwb2ludG1lbnRfZXhwb3J0cyk7CnZhciBpbXBvcnRfY29yZSA9IHJlcXVpcmUoIkBtZWRwbHVtL2NvcmUiKTsKYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihtZWRwbHVtLCBldmVudCkgewogIGNvbnN0IGFwcG9pbnRtZW50ID0gZXZlbnQuaW5wdXQ7CiAgY29uc3Qgc2xvdElkID0gKDAsIGltcG9ydF9jb3JlLnJlc29sdmVJZCkoYXBwb2ludG1lbnQuc2xvdD8uWzBdKTsKICBpZiAoIXNsb3RJZCkgewogICAgdGhyb3cgbmV3IEVycm9yKCJNdXN0IHByb3ZpZGUgYSBzbG90Iik7CiAgfQogIGNvbnN0IGVudHJpZXMgPSBbXTsKICBhcHBvaW50bWVudC5zdGF0dXMgPSAiY2FuY2VsbGVkIjsKICBhcHBvaW50bWVudC5jYW5jZWxhdGlvblJlYXNvbiA9IHsKICAgIGNvZGluZzogWwogICAgICB7CiAgICAgICAgc3lzdGVtOiAiaHR0cDovL3Rlcm1pbm9sb2d5LmhsNy5vcmcvQ29kZVN5c3RlbS9hcHBvaW50bWVudC1jYW5jZWxsYXRpb24tcmVhc29uIiwKICAgICAgICBjb2RlOiAicHJvdiIsCiAgICAgICAgZGlzcGxheTogIlByb3ZpZGVyIgogICAgICB9CiAgICBdCiAgfTsKICBlbnRyaWVzLnB1c2goewogICAgcmVxdWVzdDogewogICAgICBtZXRob2Q6ICJQVVQiLAogICAgICB1cmw6IGBBcHBvaW50bWVudD9faWQ9JHthcHBvaW50bWVudC5pZH1gCiAgICB9LAogICAgcmVzb3VyY2U6IGFwcG9pbnRtZW50CiAgfSk7CiAgY29uc3Qgc2xvdCA9IGF3YWl0IG1lZHBsdW0ucmVhZFJlc291cmNlKCJTbG90Iiwgc2xvdElkKTsKICBjb25zdCBleGlzdGluZ0ZyZWVTbG90ID0gYXdhaXQgbWVkcGx1bS5zZWFyY2hPbmUoIlNsb3QiLCB7CiAgICBzdGFydDogc2xvdC5zdGFydCwKICAgIHN0YXR1czogImZyZWUiCiAgfSk7CiAgaWYgKCFleGlzdGluZ0ZyZWVTbG90KSB7CiAgICBjb25zdCBuZXdTbG90ID0geyAuLi5zbG90LCBpZDogdm9pZCAwLCBzdGF0dXM6ICJmcmVlIiB9OwogICAgZW50cmllcy5wdXNoKHsKICAgICAgcmVxdWVzdDogewogICAgICAgIG1ldGhvZDogIlBPU1QiLAogICAgICAgIHVybDogIlNsb3QiCiAgICAgIH0sCiAgICAgIHJlc291cmNlOiBuZXdTbG90CiAgICB9KTsKICB9CiAgY29uc3QgcmVzcG9uc2VCdW5kbGUgPSBhd2FpdCBtZWRwbHVtLmV4ZWN1dGVCYXRjaCh7CiAgICByZXNvdXJjZVR5cGU6ICJCdW5kbGUiLAogICAgdHlwZTogImJhdGNoIiwKICAgIGVudHJ5OiBlbnRyaWVzCiAgfSk7CiAgcmV0dXJuIHJlc3BvbnNlQnVuZGxlOwp9Ci8vIEFubm90YXRlIHRoZSBDb21tb25KUyBleHBvcnQgbmFtZXMgZm9yIEVTTSBpbXBvcnQgaW4gbm9kZToKMCAmJiAobW9kdWxlLmV4cG9ydHMgPSB7CiAgaGFuZGxlcgp9KTsKT2JqZWN0LmFzc2lnbihleHBvcnRzLCBtb2R1bGUuZXhwb3J0cyk7Cg=="
      }
    },
    {
      "request": {
        "method": "PUT",
        "url": "$bot-cancel-appointment-reference"
      },
      "resource": {
        "resourceType": "Bot",
        "id": "$bot-cancel-appointment-id",
        "identifier": [
          {
            "system": "http://example.com",
            "value": "cancel-appointment"
          }
        ],
        "name": "cancel-appointment",
        "runtimeVersion": "awslambda",
        "sourceCode": {
          "contentType": "text/typescript",
          "url": "urn:uuid:3ef228e4-d2fc-4caa-ba5a-eb3e8e9ee75c"
        },
        "executableCode": {
          "contentType": "text/javascript",
          "url": "urn:uuid:98c8fe66-a0f0-4ead-a1c4-a75860ffbc25"
        }
      }
    },
    {
      "fullUrl": "urn:uuid:e728b5ff-8842-4247-8619-f493944b835e",
      "request": {
        "method": "POST",
        "url": "Binary"
      },
      "resource": {
        "resourceType": "Binary",
        "contentType": "text/typescript",
        "data": "aW1wb3J0IHsgQm90RXZlbnQsIE1lZHBsdW1DbGllbnQgfSBmcm9tICdAbWVkcGx1bS9jb3JlJzsKaW1wb3J0IHsgQnVuZGxlLCBCdW5kbGVFbnRyeSwgUmVmZXJlbmNlLCBSZXNvdXJjZSwgU2NoZWR1bGUsIFNsb3QgfSBmcm9tICdAbWVkcGx1bS9maGlydHlwZXMnOwoKZXhwb3J0IGludGVyZmFjZSBTZXRBdmFpbGFiaWxpdHlFdmVudCB7CiAgc2NoZWR1bGU6IFJlZmVyZW5jZTxTY2hlZHVsZT47CiAgc3RhcnREYXRlOiBzdHJpbmc7CiAgZW5kRGF0ZTogc3RyaW5nOwogIHN0YXJ0VGltZTogc3RyaW5nOwogIGVuZFRpbWU6IHN0cmluZzsKICBkdXJhdGlvbjogbnVtYmVyOwogIGRheXNPZldlZWs6IHN0cmluZ1tdOwogIHRpbWV6b25lT2Zmc2V0OiBudW1iZXI7Cn0KCmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKG1lZHBsdW06IE1lZHBsdW1DbGllbnQsIGV2ZW50OiBCb3RFdmVudDxTZXRBdmFpbGFiaWxpdHlFdmVudD4pOiBQcm9taXNlPEJ1bmRsZT4gewogIGNvbnN0IHsgc2NoZWR1bGUsIHN0YXJ0RGF0ZSwgZW5kRGF0ZSwgc3RhcnRUaW1lLCBlbmRUaW1lLCBkdXJhdGlvbiwgZGF5c09mV2VlaywgdGltZXpvbmVPZmZzZXQgfSA9IGV2ZW50LmlucHV0OwoKICAvLyBCYXNpYyBkYXRhIHZhbGlkYXRpb24KICBpZiAoZHVyYXRpb24gPD0gMCkgewogICAgdGhyb3cgbmV3IEVycm9yKCdEdXJhdGlvbiBtdXN0IGJlIGEgcG9zaXRpdmUgbnVtYmVyJyk7CiAgfQogIGlmIChuZXcgRGF0ZShlbmREYXRlKSA8IG5ldyBEYXRlKHN0YXJ0RGF0ZSkpIHsKICAgIHRocm93IG5ldyBFcnJvcignRW5kIGRhdGUgbXVzdCBiZSBhZnRlciBzdGFydCBkYXRlJyk7CiAgfQoKICAvLyBNYXAgZGF5c09mV2VlayB0byB0aGVpciBjb3JyZXNwb25kaW5nIGRheSBudW1iZXJzCiAgY29uc3QgZGF5TnVtYmVycyA9IGRheXNPZldlZWsubWFwKChkYXkpID0+IGRheU9mV2Vla01hcFtkYXkudG9Mb3dlckNhc2UoKV0pOwoKICAvLyBCdWxrIGNyZWF0ZSBmcmVlIHNsb3RzCiAgY29uc3QgZW50cmllczogQnVuZGxlRW50cnlbXSA9IFtdOwoKICBjb25zdCBlbmQgPSBuZXcgRGF0ZShlbmREYXRlKTsKICBsZXQgY3VycmVudERhdGUgPSBuZXcgRGF0ZShzdGFydERhdGUpOwoKICB3aGlsZSAoY3VycmVudERhdGUgPD0gZW5kKSB7CiAgICBpZiAoZGF5TnVtYmVycy5pbmNsdWRlcyhjdXJyZW50RGF0ZS5nZXRVVENEYXkoKSkpIHsKICAgICAgY29uc3QgZGF5U3RhcnRUaW1lID0gbmV3IERhdGUoY3VycmVudERhdGUpOwogICAgICBjb25zdCBkYXlFbmRUaW1lID0gbmV3IERhdGUoY3VycmVudERhdGUpOwoKICAgICAgLy8gU2V0IHRoZSBzdGFydCBhbmQgZW5kIHRpbWVzIGZvciB0aGUgZGF5CiAgICAgIGNvbnN0IFtzdGFydEhvdXIsIHN0YXJ0TWludXRlXSA9IHN0YXJ0VGltZS5zcGxpdCgnOicpLm1hcChOdW1iZXIpOwogICAgICBjb25zdCBbZW5kSG91ciwgZW5kTWludXRlXSA9IGVuZFRpbWUuc3BsaXQoJzonKS5tYXAoTnVtYmVyKTsKCiAgICAgIGRheVN0YXJ0VGltZS5zZXRIb3VycyhzdGFydEhvdXIsIHN0YXJ0TWludXRlLCAwLCAwKTsKICAgICAgZGF5RW5kVGltZS5zZXRIb3VycyhlbmRIb3VyLCBlbmRNaW51dGUsIDAsIDApOwoKICAgICAgLy8gQWRqdXN0IGZvciB0aW1lem9uZSBvZmZzZXQKICAgICAgZGF5U3RhcnRUaW1lLnNldE1pbnV0ZXMoZGF5U3RhcnRUaW1lLmdldE1pbnV0ZXMoKSArIHRpbWV6b25lT2Zmc2V0KTsKICAgICAgZGF5RW5kVGltZS5zZXRNaW51dGVzKGRheUVuZFRpbWUuZ2V0TWludXRlcygpICsgdGltZXpvbmVPZmZzZXQpOwoKICAgICAgbGV0IGN1cnJlbnRTbG90VGltZSA9IG5ldyBEYXRlKGRheVN0YXJ0VGltZSk7CgogICAgICAvLyBDcmVhdGUgc2xvdHMgd2l0aGluIHRoZSBzcGVjaWZpZWQgdGltZSB3aW5kb3cKICAgICAgd2hpbGUgKGN1cnJlbnRTbG90VGltZSA8IGRheUVuZFRpbWUpIHsKICAgICAgICBjb25zdCBzbG90RW5kVGltZSA9IG5ldyBEYXRlKGN1cnJlbnRTbG90VGltZS5nZXRUaW1lKCkgKyBkdXJhdGlvbiAqIDYwMDAwKTsKCiAgICAgICAgLy8gRW5zdXJlIHRoYXQgdGhlIHNsb3QgZG9lcyBub3QgZXhjZWVkIHRoZSBlbmQgdGltZQogICAgICAgIGlmIChzbG90RW5kVGltZSA8PSBkYXlFbmRUaW1lKSB7CiAgICAgICAgICBjb25zdCBzbG90ID0gY3JlYXRlRnJlZVNsb3Qoc2NoZWR1bGUsIGN1cnJlbnRTbG90VGltZSwgZHVyYXRpb24pOwogICAgICAgICAgZW50cmllcy5wdXNoKGNyZWF0ZUVudHJ5KHNsb3QpKTsKICAgICAgICB9CgogICAgICAgIC8vIE1vdmUgdG8gdGhlIG5leHQgc2xvdAogICAgICAgIGN1cnJlbnRTbG90VGltZSA9IG5ldyBEYXRlKGN1cnJlbnRTbG90VGltZS5nZXRUaW1lKCkgKyBkdXJhdGlvbiAqIDYwMDAwKTsKICAgICAgfQogICAgfQogICAgLy8gTW92ZSB0byB0aGUgbmV4dCBkYXkKICAgIGN1cnJlbnREYXRlID0gbmV3IERhdGUoY3VycmVudERhdGUuc2V0VVRDRGF0ZShjdXJyZW50RGF0ZS5nZXRVVENEYXRlKCkgKyAxKSk7CiAgfQoKICAvLyBFeGVjdXRlIGJhdGNoIHRvIGNyZWF0ZSBhbGwgc2xvdHMgYXQgb25jZQogIGNvbnN0IHJlc3BvbnNlQnVuZGxlID0gYXdhaXQgbWVkcGx1bS5leGVjdXRlQmF0Y2goewogICAgcmVzb3VyY2VUeXBlOiAnQnVuZGxlJywKICAgIHR5cGU6ICdiYXRjaCcsCiAgICBlbnRyeTogZW50cmllcywKICB9KTsKICByZXR1cm4gcmVzcG9uc2VCdW5kbGU7Cn0KCmNvbnN0IGRheU9mV2Vla01hcDogUmVjb3JkPHN0cmluZywgbnVtYmVyPiA9IHsKICBzdW46IDAsCiAgbW9uOiAxLAogIHR1ZTogMiwKICB3ZWQ6IDMsCiAgdGh1OiA0LAogIGZyaTogNSwKICBzYXQ6IDYsCn07CgpmdW5jdGlvbiBjcmVhdGVFbnRyeShyZXNvdXJjZTogUmVzb3VyY2UpOiBCdW5kbGVFbnRyeSB7CiAgcmV0dXJuIHsKICAgIHJlc291cmNlLAogICAgcmVxdWVzdDogewogICAgICB1cmw6IHJlc291cmNlLnJlc291cmNlVHlwZSwKICAgICAgbWV0aG9kOiAnUE9TVCcsCiAgICB9LAogIH07Cn0KCmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVGcmVlU2xvdChzY2hlZHVsZTogUmVmZXJlbmNlPFNjaGVkdWxlPiwgc3RhcnQ6IERhdGUsIGR1cmF0aW9uOiBudW1iZXIpOiBTbG90IHsKICByZXR1cm4gewogICAgcmVzb3VyY2VUeXBlOiAnU2xvdCcsCiAgICBzY2hlZHVsZTogc2NoZWR1bGUsCiAgICBzdGFydDogc3RhcnQudG9JU09TdHJpbmcoKSwKICAgIGVuZDogbmV3IERhdGUoc3RhcnQuZ2V0VGltZSgpICsgZHVyYXRpb24gKiA2MDAwMCkudG9JU09TdHJpbmcoKSwKICAgIHN0YXR1czogJ2ZyZWUnLAogIH07Cn0K"
      }
    },
    {
      "fullUrl": "urn:uuid:8e9cb90a-9707-47cf-8d02-d762e33d0870",
      "request": {
        "method": "POST",
        "url": "Binary"
      },
      "resource": {
        "resourceType": "Binary",
        "contentType": "text/javascript",
        "data": "InVzZSBzdHJpY3QiOwp2YXIgX19kZWZQcm9wID0gT2JqZWN0LmRlZmluZVByb3BlcnR5Owp2YXIgX19nZXRPd25Qcm9wRGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I7CnZhciBfX2dldE93blByb3BOYW1lcyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzOwp2YXIgX19oYXNPd25Qcm9wID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTsKdmFyIF9fZXhwb3J0ID0gKHRhcmdldCwgYWxsKSA9PiB7CiAgZm9yICh2YXIgbmFtZSBpbiBhbGwpCiAgICBfX2RlZlByb3AodGFyZ2V0LCBuYW1lLCB7IGdldDogYWxsW25hbWVdLCBlbnVtZXJhYmxlOiB0cnVlIH0pOwp9Owp2YXIgX19jb3B5UHJvcHMgPSAodG8sIGZyb20sIGV4Y2VwdCwgZGVzYykgPT4gewogIGlmIChmcm9tICYmIHR5cGVvZiBmcm9tID09PSAib2JqZWN0IiB8fCB0eXBlb2YgZnJvbSA9PT0gImZ1bmN0aW9uIikgewogICAgZm9yIChsZXQga2V5IG9mIF9fZ2V0T3duUHJvcE5hbWVzKGZyb20pKQogICAgICBpZiAoIV9faGFzT3duUHJvcC5jYWxsKHRvLCBrZXkpICYmIGtleSAhPT0gZXhjZXB0KQogICAgICAgIF9fZGVmUHJvcCh0bywga2V5LCB7IGdldDogKCkgPT4gZnJvbVtrZXldLCBlbnVtZXJhYmxlOiAhKGRlc2MgPSBfX2dldE93blByb3BEZXNjKGZyb20sIGtleSkpIHx8IGRlc2MuZW51bWVyYWJsZSB9KTsKICB9CiAgcmV0dXJuIHRvOwp9Owp2YXIgX190b0NvbW1vbkpTID0gKG1vZCkgPT4gX19jb3B5UHJvcHMoX19kZWZQcm9wKHt9LCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSksIG1vZCk7CgovLyBzcmMvYm90cy9jb3JlL3NldC1hdmFpbGFiaWxpdHkudHMKdmFyIHNldF9hdmFpbGFiaWxpdHlfZXhwb3J0cyA9IHt9OwpfX2V4cG9ydChzZXRfYXZhaWxhYmlsaXR5X2V4cG9ydHMsIHsKICBjcmVhdGVGcmVlU2xvdDogKCkgPT4gY3JlYXRlRnJlZVNsb3QsCiAgaGFuZGxlcjogKCkgPT4gaGFuZGxlcgp9KTsKbW9kdWxlLmV4cG9ydHMgPSBfX3RvQ29tbW9uSlMoc2V0X2F2YWlsYWJpbGl0eV9leHBvcnRzKTsKYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihtZWRwbHVtLCBldmVudCkgewogIGNvbnN0IHsgc2NoZWR1bGUsIHN0YXJ0RGF0ZSwgZW5kRGF0ZSwgc3RhcnRUaW1lLCBlbmRUaW1lLCBkdXJhdGlvbiwgZGF5c09mV2VlaywgdGltZXpvbmVPZmZzZXQgfSA9IGV2ZW50LmlucHV0OwogIGlmIChkdXJhdGlvbiA8PSAwKSB7CiAgICB0aHJvdyBuZXcgRXJyb3IoIkR1cmF0aW9uIG11c3QgYmUgYSBwb3NpdGl2ZSBudW1iZXIiKTsKICB9CiAgaWYgKG5ldyBEYXRlKGVuZERhdGUpIDwgbmV3IERhdGUoc3RhcnREYXRlKSkgewogICAgdGhyb3cgbmV3IEVycm9yKCJFbmQgZGF0ZSBtdXN0IGJlIGFmdGVyIHN0YXJ0IGRhdGUiKTsKICB9CiAgY29uc3QgZGF5TnVtYmVycyA9IGRheXNPZldlZWsubWFwKChkYXkpID0+IGRheU9mV2Vla01hcFtkYXkudG9Mb3dlckNhc2UoKV0pOwogIGNvbnN0IGVudHJpZXMgPSBbXTsKICBjb25zdCBlbmQgPSBuZXcgRGF0ZShlbmREYXRlKTsKICBsZXQgY3VycmVudERhdGUgPSBuZXcgRGF0ZShzdGFydERhdGUpOwogIHdoaWxlIChjdXJyZW50RGF0ZSA8PSBlbmQpIHsKICAgIGlmIChkYXlOdW1iZXJzLmluY2x1ZGVzKGN1cnJlbnREYXRlLmdldFVUQ0RheSgpKSkgewogICAgICBjb25zdCBkYXlTdGFydFRpbWUgPSBuZXcgRGF0ZShjdXJyZW50RGF0ZSk7CiAgICAgIGNvbnN0IGRheUVuZFRpbWUgPSBuZXcgRGF0ZShjdXJyZW50RGF0ZSk7CiAgICAgIGNvbnN0IFtzdGFydEhvdXIsIHN0YXJ0TWludXRlXSA9IHN0YXJ0VGltZS5zcGxpdCgiOiIpLm1hcChOdW1iZXIpOwogICAgICBjb25zdCBbZW5kSG91ciwgZW5kTWludXRlXSA9IGVuZFRpbWUuc3BsaXQoIjoiKS5tYXAoTnVtYmVyKTsKICAgICAgZGF5U3RhcnRUaW1lLnNldEhvdXJzKHN0YXJ0SG91ciwgc3RhcnRNaW51dGUsIDAsIDApOwogICAgICBkYXlFbmRUaW1lLnNldEhvdXJzKGVuZEhvdXIsIGVuZE1pbnV0ZSwgMCwgMCk7CiAgICAgIGRheVN0YXJ0VGltZS5zZXRNaW51dGVzKGRheVN0YXJ0VGltZS5nZXRNaW51dGVzKCkgKyB0aW1lem9uZU9mZnNldCk7CiAgICAgIGRheUVuZFRpbWUuc2V0TWludXRlcyhkYXlFbmRUaW1lLmdldE1pbnV0ZXMoKSArIHRpbWV6b25lT2Zmc2V0KTsKICAgICAgbGV0IGN1cnJlbnRTbG90VGltZSA9IG5ldyBEYXRlKGRheVN0YXJ0VGltZSk7CiAgICAgIHdoaWxlIChjdXJyZW50U2xvdFRpbWUgPCBkYXlFbmRUaW1lKSB7CiAgICAgICAgY29uc3Qgc2xvdEVuZFRpbWUgPSBuZXcgRGF0ZShjdXJyZW50U2xvdFRpbWUuZ2V0VGltZSgpICsgZHVyYXRpb24gKiA2ZTQpOwogICAgICAgIGlmIChzbG90RW5kVGltZSA8PSBkYXlFbmRUaW1lKSB7CiAgICAgICAgICBjb25zdCBzbG90ID0gY3JlYXRlRnJlZVNsb3Qoc2NoZWR1bGUsIGN1cnJlbnRTbG90VGltZSwgZHVyYXRpb24pOwogICAgICAgICAgZW50cmllcy5wdXNoKGNyZWF0ZUVudHJ5KHNsb3QpKTsKICAgICAgICB9CiAgICAgICAgY3VycmVudFNsb3RUaW1lID0gbmV3IERhdGUoY3VycmVudFNsb3RUaW1lLmdldFRpbWUoKSArIGR1cmF0aW9uICogNmU0KTsKICAgICAgfQogICAgfQogICAgY3VycmVudERhdGUgPSBuZXcgRGF0ZShjdXJyZW50RGF0ZS5zZXRVVENEYXRlKGN1cnJlbnREYXRlLmdldFVUQ0RhdGUoKSArIDEpKTsKICB9CiAgY29uc3QgcmVzcG9uc2VCdW5kbGUgPSBhd2FpdCBtZWRwbHVtLmV4ZWN1dGVCYXRjaCh7CiAgICByZXNvdXJjZVR5cGU6ICJCdW5kbGUiLAogICAgdHlwZTogImJhdGNoIiwKICAgIGVudHJ5OiBlbnRyaWVzCiAgfSk7CiAgcmV0dXJuIHJlc3BvbnNlQnVuZGxlOwp9CnZhciBkYXlPZldlZWtNYXAgPSB7CiAgc3VuOiAwLAogIG1vbjogMSwKICB0dWU6IDIsCiAgd2VkOiAzLAogIHRodTogNCwKICBmcmk6IDUsCiAgc2F0OiA2Cn07CmZ1bmN0aW9uIGNyZWF0ZUVudHJ5KHJlc291cmNlKSB7CiAgcmV0dXJuIHsKICAgIHJlc291cmNlLAogICAgcmVxdWVzdDogewogICAgICB1cmw6IHJlc291cmNlLnJlc291cmNlVHlwZSwKICAgICAgbWV0aG9kOiAiUE9TVCIKICAgIH0KICB9Owp9CmZ1bmN0aW9uIGNyZWF0ZUZyZWVTbG90KHNjaGVkdWxlLCBzdGFydCwgZHVyYXRpb24pIHsKICByZXR1cm4gewogICAgcmVzb3VyY2VUeXBlOiAiU2xvdCIsCiAgICBzY2hlZHVsZSwKICAgIHN0YXJ0OiBzdGFydC50b0lTT1N0cmluZygpLAogICAgZW5kOiBuZXcgRGF0ZShzdGFydC5nZXRUaW1lKCkgKyBkdXJhdGlvbiAqIDZlNCkudG9JU09TdHJpbmcoKSwKICAgIHN0YXR1czogImZyZWUiCiAgfTsKfQovLyBBbm5vdGF0ZSB0aGUgQ29tbW9uSlMgZXhwb3J0IG5hbWVzIGZvciBFU00gaW1wb3J0IGluIG5vZGU6CjAgJiYgKG1vZHVsZS5leHBvcnRzID0gewogIGNyZWF0ZUZyZWVTbG90LAogIGhhbmRsZXIKfSk7Ck9iamVjdC5hc3NpZ24oZXhwb3J0cywgbW9kdWxlLmV4cG9ydHMpOwo="
      }
    },
    {
      "request": {
        "method": "PUT",
        "url": "$bot-set-availability-reference"
      },
      "resource": {
        "resourceType": "Bot",
        "id": "$bot-set-availability-id",
        "identifier": [
          {
            "system": "http://example.com",
            "value": "set-availability"
          }
        ],
        "name": "set-availability",
        "runtimeVersion": "awslambda",
        "sourceCode": {
          "contentType": "text/typescript",
          "url": "urn:uuid:e728b5ff-8842-4247-8619-f493944b835e"
        },
        "executableCode": {
          "contentType": "text/javascript",
          "url": "urn:uuid:8e9cb90a-9707-47cf-8d02-d762e33d0870"
        }
      }
    },
    {
      "fullUrl": "urn:uuid:0d12d6d9-1ba0-4381-9b71-b0e5686ecea7",
      "request": {
        "method": "POST",
        "url": "Binary"
      },
      "resource": {
        "resourceType": "Binary",
        "contentType": "text/typescript",
        "data": "aW1wb3J0IHsgTWVkcGx1bUNsaWVudCwgQm90RXZlbnQgfSBmcm9tICdAbWVkcGx1bS9jb3JlJzsKaW1wb3J0IHsgQXBwb2ludG1lbnQsIEJ1bmRsZSwgQnVuZGxlRW50cnksIFJlZmVyZW5jZSwgU2NoZWR1bGUsIFNsb3QgfSBmcm9tICdAbWVkcGx1bS9maGlydHlwZXMnOwoKZXhwb3J0IGludGVyZmFjZSBCbG9ja0F2YWlsYWJpbGl0eUV2ZW50IHsKICBzY2hlZHVsZTogUmVmZXJlbmNlPFNjaGVkdWxlPjsKICBzdGFydDogc3RyaW5nOwogIGVuZDogc3RyaW5nOwp9CgpleHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihtZWRwbHVtOiBNZWRwbHVtQ2xpZW50LCBldmVudDogQm90RXZlbnQ8QmxvY2tBdmFpbGFiaWxpdHlFdmVudD4pOiBQcm9taXNlPEJ1bmRsZT4gewogIGNvbnN0IHsgc2NoZWR1bGUsIHN0YXJ0LCBlbmQgfSA9IGV2ZW50LmlucHV0OwoKICAvLyBCYXNpYyBkYXRhIHZhbGlkYXRpb24KICBpZiAobmV3IERhdGUoZW5kKSA8IG5ldyBEYXRlKHN0YXJ0KSkgewogICAgdGhyb3cgbmV3IEVycm9yKCdFbmQgZGF0ZSBtdXN0IGJlIGFmdGVyIHN0YXJ0IGRhdGUnKTsKICB9CgogIGNvbnN0IGVudHJpZXM6IEJ1bmRsZUVudHJ5W10gPSBbXTsKCiAgLy8gQ3JlYXRlIGEgU2xvdCB3aXRoIHN0YXR1cyAnYnVzeS11bmF2YWlsYWJsZScgZm9yIHRoZSBwZXJpb2QKICBjb25zdCBibG9ja2VkU2xvdDogU2xvdCA9IHsKICAgIHJlc291cmNlVHlwZTogJ1Nsb3QnLAogICAgc2NoZWR1bGU6IHNjaGVkdWxlLAogICAgc3RhcnQ6IHN0YXJ0LAogICAgZW5kOiBlbmQsCiAgICBzdGF0dXM6ICdidXN5LXVuYXZhaWxhYmxlJywKICB9OwogIGVudHJpZXMucHVzaCh7CiAgICByZXF1ZXN0OiB7CiAgICAgIG1ldGhvZDogJ1BPU1QnLAogICAgICB1cmw6ICdTbG90JywKICAgIH0sCiAgICByZXNvdXJjZTogYmxvY2tlZFNsb3QsCiAgfSk7CgogIC8vIENhbmNlbCBib29rZWQgYXBwb2ludG1lbnRzIHRoYXQgb3ZlcmxhcCB0aGUgcGVyaW9kCiAgY29uc3QgYXBwb2ludG1lbnRzVG9DYW5jZWw6IEFwcG9pbnRtZW50W10gPSBhd2FpdCBtZWRwbHVtLnNlYXJjaFJlc291cmNlcygKICAgICdBcHBvaW50bWVudCcsCiAgICBgZGF0ZT1sdCR7ZW5kfSZkYXRlPWdlJHtzdGFydH0mc3RhdHVzPWJvb2tlZGAKICApOwogIGVudHJpZXMucHVzaCgKICAgIC4uLmFwcG9pbnRtZW50c1RvQ2FuY2VsLm1hcCgKICAgICAgKGFwcG9pbnRtZW50KTogQnVuZGxlRW50cnkgPT4gKHsKICAgICAgICByZXF1ZXN0OiB7CiAgICAgICAgICBtZXRob2Q6ICdQVVQnLAogICAgICAgICAgdXJsOiBgQXBwb2ludG1lbnQ/X2lkPSR7YXBwb2ludG1lbnQuaWR9YCwKICAgICAgICB9LAogICAgICAgIHJlc291cmNlOiB7CiAgICAgICAgICAuLi5hcHBvaW50bWVudCwKICAgICAgICAgIHN0YXR1czogJ2NhbmNlbGxlZCcsCiAgICAgICAgICBjYW5jZWxhdGlvblJlYXNvbjogewogICAgICAgICAgICBjb2Rpbmc6IFsKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBzeXN0ZW06ICdodHRwOi8vdGVybWlub2xvZ3kuaGw3Lm9yZy9Db2RlU3lzdGVtL2FwcG9pbnRtZW50LWNhbmNlbGxhdGlvbi1yZWFzb24nLAogICAgICAgICAgICAgICAgY29kZTogJ3Byb3YnLAogICAgICAgICAgICAgICAgZGlzcGxheTogJ1Byb3ZpZGVyJywKICAgICAgICAgICAgICB9LAogICAgICAgICAgICBdLAogICAgICAgICAgfSwKICAgICAgICB9LAogICAgICB9KQogICAgKQogICk7CgogIC8vIEJsb2NrIGZyZWUgc2xvdHMgdGhhdCBvdmVybGFwIHRoZSBwZXJpb2QKICBjb25zdCBmcmVlU2xvdHNUb0Jsb2NrOiBTbG90W10gPSBhd2FpdCBtZWRwbHVtLnNlYXJjaFJlc291cmNlcygKICAgICdTbG90JywKICAgIGBzY2hlZHVsZT0ke3NjaGVkdWxlLnJlZmVyZW5jZX0mc3RhcnQ9bHQke2VuZH0mc3RhcnQ9Z2Uke3N0YXJ0fSZzdGF0dXM9ZnJlZWAKICApOwogIGVudHJpZXMucHVzaCgKICAgIC4uLmZyZWVTbG90c1RvQmxvY2subWFwKAogICAgICAoc2xvdCk6IEJ1bmRsZUVudHJ5ID0+ICh7CiAgICAgICAgcmVxdWVzdDogewogICAgICAgICAgbWV0aG9kOiAnUFVUJywKICAgICAgICAgIHVybDogYFNsb3Q/X2lkPSR7c2xvdC5pZH1gLAogICAgICAgIH0sCiAgICAgICAgcmVzb3VyY2U6IHsKICAgICAgICAgIC4uLnNsb3QsCiAgICAgICAgICBzdGF0dXM6ICdidXN5LXVuYXZhaWxhYmxlJywKICAgICAgICB9LAogICAgICB9KQogICAgKQogICk7CgogIC8vIEV4ZWN1dGUgdGhlIGJhdGNoIHRvIGNyZWF0ZS91cGRhdGUgYWxsIHJlc291cmNlcyBhdCBvbmNlCiAgY29uc3QgcmVzcG9uc2VCdW5kbGUgPSBhd2FpdCBtZWRwbHVtLmV4ZWN1dGVCYXRjaCh7CiAgICByZXNvdXJjZVR5cGU6ICdCdW5kbGUnLAogICAgdHlwZTogJ2JhdGNoJywKICAgIGVudHJ5OiBlbnRyaWVzLAogIH0pOwogIHJldHVybiByZXNwb25zZUJ1bmRsZTsKfQo="
      }
    },
    {
      "fullUrl": "urn:uuid:f6c3b380-d7ff-4e7d-8184-e9082c80296e",
      "request": {
        "method": "POST",
        "url": "Binary"
      },
      "resource": {
        "resourceType": "Binary",
        "contentType": "text/javascript",
        "data": "InVzZSBzdHJpY3QiOwp2YXIgX19kZWZQcm9wID0gT2JqZWN0LmRlZmluZVByb3BlcnR5Owp2YXIgX19nZXRPd25Qcm9wRGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I7CnZhciBfX2dldE93blByb3BOYW1lcyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzOwp2YXIgX19oYXNPd25Qcm9wID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTsKdmFyIF9fZXhwb3J0ID0gKHRhcmdldCwgYWxsKSA9PiB7CiAgZm9yICh2YXIgbmFtZSBpbiBhbGwpCiAgICBfX2RlZlByb3AodGFyZ2V0LCBuYW1lLCB7IGdldDogYWxsW25hbWVdLCBlbnVtZXJhYmxlOiB0cnVlIH0pOwp9Owp2YXIgX19jb3B5UHJvcHMgPSAodG8sIGZyb20sIGV4Y2VwdCwgZGVzYykgPT4gewogIGlmIChmcm9tICYmIHR5cGVvZiBmcm9tID09PSAib2JqZWN0IiB8fCB0eXBlb2YgZnJvbSA9PT0gImZ1bmN0aW9uIikgewogICAgZm9yIChsZXQga2V5IG9mIF9fZ2V0T3duUHJvcE5hbWVzKGZyb20pKQogICAgICBpZiAoIV9faGFzT3duUHJvcC5jYWxsKHRvLCBrZXkpICYmIGtleSAhPT0gZXhjZXB0KQogICAgICAgIF9fZGVmUHJvcCh0bywga2V5LCB7IGdldDogKCkgPT4gZnJvbVtrZXldLCBlbnVtZXJhYmxlOiAhKGRlc2MgPSBfX2dldE93blByb3BEZXNjKGZyb20sIGtleSkpIHx8IGRlc2MuZW51bWVyYWJsZSB9KTsKICB9CiAgcmV0dXJuIHRvOwp9Owp2YXIgX190b0NvbW1vbkpTID0gKG1vZCkgPT4gX19jb3B5UHJvcHMoX19kZWZQcm9wKHt9LCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSksIG1vZCk7CgovLyBzcmMvYm90cy9jb3JlL2Jsb2NrLWF2YWlsYWJpbGl0eS50cwp2YXIgYmxvY2tfYXZhaWxhYmlsaXR5X2V4cG9ydHMgPSB7fTsKX19leHBvcnQoYmxvY2tfYXZhaWxhYmlsaXR5X2V4cG9ydHMsIHsKICBoYW5kbGVyOiAoKSA9PiBoYW5kbGVyCn0pOwptb2R1bGUuZXhwb3J0cyA9IF9fdG9Db21tb25KUyhibG9ja19hdmFpbGFiaWxpdHlfZXhwb3J0cyk7CmFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIobWVkcGx1bSwgZXZlbnQpIHsKICBjb25zdCB7IHNjaGVkdWxlLCBzdGFydCwgZW5kIH0gPSBldmVudC5pbnB1dDsKICBpZiAobmV3IERhdGUoZW5kKSA8IG5ldyBEYXRlKHN0YXJ0KSkgewogICAgdGhyb3cgbmV3IEVycm9yKCJFbmQgZGF0ZSBtdXN0IGJlIGFmdGVyIHN0YXJ0IGRhdGUiKTsKICB9CiAgY29uc3QgZW50cmllcyA9IFtdOwogIGNvbnN0IGJsb2NrZWRTbG90ID0gewogICAgcmVzb3VyY2VUeXBlOiAiU2xvdCIsCiAgICBzY2hlZHVsZSwKICAgIHN0YXJ0LAogICAgZW5kLAogICAgc3RhdHVzOiAiYnVzeS11bmF2YWlsYWJsZSIKICB9OwogIGVudHJpZXMucHVzaCh7CiAgICByZXF1ZXN0OiB7CiAgICAgIG1ldGhvZDogIlBPU1QiLAogICAgICB1cmw6ICJTbG90IgogICAgfSwKICAgIHJlc291cmNlOiBibG9ja2VkU2xvdAogIH0pOwogIGNvbnN0IGFwcG9pbnRtZW50c1RvQ2FuY2VsID0gYXdhaXQgbWVkcGx1bS5zZWFyY2hSZXNvdXJjZXMoCiAgICAiQXBwb2ludG1lbnQiLAogICAgYGRhdGU9bHQke2VuZH0mZGF0ZT1nZSR7c3RhcnR9JnN0YXR1cz1ib29rZWRgCiAgKTsKICBlbnRyaWVzLnB1c2goCiAgICAuLi5hcHBvaW50bWVudHNUb0NhbmNlbC5tYXAoCiAgICAgIChhcHBvaW50bWVudCkgPT4gKHsKICAgICAgICByZXF1ZXN0OiB7CiAgICAgICAgICBtZXRob2Q6ICJQVVQiLAogICAgICAgICAgdXJsOiBgQXBwb2ludG1lbnQ/X2lkPSR7YXBwb2ludG1lbnQuaWR9YAogICAgICAgIH0sCiAgICAgICAgcmVzb3VyY2U6IHsKICAgICAgICAgIC4uLmFwcG9pbnRtZW50LAogICAgICAgICAgc3RhdHVzOiAiY2FuY2VsbGVkIiwKICAgICAgICAgIGNhbmNlbGF0aW9uUmVhc29uOiB7CiAgICAgICAgICAgIGNvZGluZzogWwogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHN5c3RlbTogImh0dHA6Ly90ZXJtaW5vbG9neS5obDcub3JnL0NvZGVTeXN0ZW0vYXBwb2ludG1lbnQtY2FuY2VsbGF0aW9uLXJlYXNvbiIsCiAgICAgICAgICAgICAgICBjb2RlOiAicHJvdiIsCiAgICAgICAgICAgICAgICBkaXNwbGF5OiAiUHJvdmlkZXIiCiAgICAgICAgICAgICAgfQogICAgICAgICAgICBdCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KQogICAgKQogICk7CiAgY29uc3QgZnJlZVNsb3RzVG9CbG9jayA9IGF3YWl0IG1lZHBsdW0uc2VhcmNoUmVzb3VyY2VzKAogICAgIlNsb3QiLAogICAgYHNjaGVkdWxlPSR7c2NoZWR1bGUucmVmZXJlbmNlfSZzdGFydD1sdCR7ZW5kfSZzdGFydD1nZSR7c3RhcnR9JnN0YXR1cz1mcmVlYAogICk7CiAgZW50cmllcy5wdXNoKAogICAgLi4uZnJlZVNsb3RzVG9CbG9jay5tYXAoCiAgICAgIChzbG90KSA9PiAoewogICAgICAgIHJlcXVlc3Q6IHsKICAgICAgICAgIG1ldGhvZDogIlBVVCIsCiAgICAgICAgICB1cmw6IGBTbG90P19pZD0ke3Nsb3QuaWR9YAogICAgICAgIH0sCiAgICAgICAgcmVzb3VyY2U6IHsKICAgICAgICAgIC4uLnNsb3QsCiAgICAgICAgICBzdGF0dXM6ICJidXN5LXVuYXZhaWxhYmxlIgogICAgICAgIH0KICAgICAgfSkKICAgICkKICApOwogIGNvbnN0IHJlc3BvbnNlQnVuZGxlID0gYXdhaXQgbWVkcGx1bS5leGVjdXRlQmF0Y2goewogICAgcmVzb3VyY2VUeXBlOiAiQnVuZGxlIiwKICAgIHR5cGU6ICJiYXRjaCIsCiAgICBlbnRyeTogZW50cmllcwogIH0pOwogIHJldHVybiByZXNwb25zZUJ1bmRsZTsKfQovLyBBbm5vdGF0ZSB0aGUgQ29tbW9uSlMgZXhwb3J0IG5hbWVzIGZvciBFU00gaW1wb3J0IGluIG5vZGU6CjAgJiYgKG1vZHVsZS5leHBvcnRzID0gewogIGhhbmRsZXIKfSk7Ck9iamVjdC5hc3NpZ24oZXhwb3J0cywgbW9kdWxlLmV4cG9ydHMpOwo="
      }
    },
    {
      "request": {
        "method": "PUT",
        "url": "$bot-block-availability-reference"
      },
      "resource": {
        "resourceType": "Bot",
        "id": "$bot-block-availability-id",
        "identifier": [
          {
            "system": "http://example.com",
            "value": "block-availability"
          }
        ],
        "name": "block-availability",
        "runtimeVersion": "awslambda",
        "sourceCode": {
          "contentType": "text/typescript",
          "url": "urn:uuid:0d12d6d9-1ba0-4381-9b71-b0e5686ecea7"
        },
        "executableCode": {
          "contentType": "text/javascript",
          "url": "urn:uuid:f6c3b380-d7ff-4e7d-8184-e9082c80296e"
        }
      }
    },
    {
      "fullUrl": "urn:uuid:56556a96-88dc-4c49-8bed-4a7f73d69a23",
      "request": {
        "method": "POST",
        "url": "Binary"
      },
      "resource": {
        "resourceType": "Binary",
        "contentType": "text/typescript",
        "data": "aW1wb3J0IHsgQm90RXZlbnQsIGNyZWF0ZVJlZmVyZW5jZSwgZ2V0UmVmZXJlbmNlU3RyaW5nLCBNZWRwbHVtQ2xpZW50IH0gZnJvbSAnQG1lZHBsdW0vY29yZSc7CmltcG9ydCB7CiAgQXBwb2ludG1lbnQsCiAgQnVuZGxlLAogIEJ1bmRsZUVudHJ5LAogIENvZGVhYmxlQ29uY2VwdCwKICBFbmNvdW50ZXIsCiAgUGF0aWVudCwKICBQcmFjdGl0aW9uZXIsCiAgUmVmZXJlbmNlLAogIFNjaGVkdWxlLAogIFNsb3QsCn0gZnJvbSAnQG1lZHBsdW0vZmhpcnR5cGVzJzsKaW1wb3J0IHsgcmFuZG9tVVVJRCB9IGZyb20gJ2NyeXB0byc7CgpleHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihtZWRwbHVtOiBNZWRwbHVtQ2xpZW50LCBldmVudDogQm90RXZlbnQ8UHJhY3RpdGlvbmVyPik6IFByb21pc2U8QnVuZGxlPiB7CiAgY29uc3QgcHJhY3RpdGlvbmVyID0gZXZlbnQuaW5wdXQgYXMgUHJhY3RpdGlvbmVyOwoKICAvLyBOb3RlIHRoYXQgdGhlIFNjaGVkdWxlIHJlc291cmNlIGlzIGNyZWF0ZWQgaW4gdGhlIEFwcC50c3ggZmlsZQogIGNvbnN0IHNjaGVkdWxlID0gYXdhaXQgbWVkcGx1bS5zZWFyY2hPbmUoJ1NjaGVkdWxlJywgeyBhY3RvcjogZ2V0UmVmZXJlbmNlU3RyaW5nKHByYWN0aXRpb25lcikgfSk7CiAgaWYgKCFzY2hlZHVsZSkgewogICAgdGhyb3cgbmV3IEVycm9yKCdTY2hlZHVsZSBub3QgZm91bmQnKTsKICB9CgogIGNvbnN0IGVudHJpZXM6IEJ1bmRsZUVudHJ5PFBhdGllbnQgfCBTbG90IHwgQXBwb2ludG1lbnQgfCBFbmNvdW50ZXI+W10gPSBbLi4uY3JlYXRlUGF0aWVudEVudHJpZXMoKV07CgogIGNvbnN0IHByYWN0aXRpb25lclJlZmVyZW5jZSA9IGNyZWF0ZVJlZmVyZW5jZShwcmFjdGl0aW9uZXIpOwogIGNvbnN0IGhvbWVyUmVmZXJlbmNlID0geyByZWZlcmVuY2U6ICd1cm46dXVpZDpiZDkwYWZjYy00ZjQ0LTRjMTMtODcxMC04NGRkYzFiY2UzNDcnLCBkaXNwbGF5OiAnSG9tZXIgU2ltcHNvbicgfTsKICBjb25zdCBtYXJnZVJlZmVyZW5jZSA9IHsgcmVmZXJlbmNlOiAndXJuOnV1aWQ6ZWNhNjYzNTItNDE1Yy00ZGFiLWFkZDEtZTRlZDhhMTU2NDA4JywgZGlzcGxheTogJ01hcmdlIFNpbXBzb24nIH07CiAgY29uc3Qgc2NoZWR1bGVSZWZlcmVuY2UgPSBjcmVhdGVSZWZlcmVuY2Uoc2NoZWR1bGUpOwoKICBjb25zdCB0b2RheSA9IG5ldyBEYXRlKCk7CgogIC8vIENyZWF0ZSBzbG90cyBhbmQgYXBwb2ludG1lbnRzIGZvciB0aGUgcHJldmlvdXMgd2VlaywgdGhpcyB3ZWVrLCBhbmQgbmV4dCB3ZWVrCiAgY3JlYXRlV2Vla1Nsb3RzKHRvZGF5LCAtMSwgZW50cmllcywgc2NoZWR1bGVSZWZlcmVuY2UsIHByYWN0aXRpb25lclJlZmVyZW5jZSwgW21hcmdlUmVmZXJlbmNlLCBob21lclJlZmVyZW5jZV0pOwogIGNyZWF0ZVdlZWtTbG90cyh0b2RheSwgMCwgZW50cmllcywgc2NoZWR1bGVSZWZlcmVuY2UsIHByYWN0aXRpb25lclJlZmVyZW5jZSwgW21hcmdlUmVmZXJlbmNlLCBob21lclJlZmVyZW5jZV0pOwogIGNyZWF0ZVdlZWtTbG90cyh0b2RheSwgMSwgZW50cmllcywgc2NoZWR1bGVSZWZlcmVuY2UsIHByYWN0aXRpb25lclJlZmVyZW5jZSwgW21hcmdlUmVmZXJlbmNlLCBob21lclJlZmVyZW5jZV0pOwoKICBjb25zdCBidW5kbGU6IEJ1bmRsZSA9IHsKICAgIHJlc291cmNlVHlwZTogJ0J1bmRsZScsCiAgICB0eXBlOiAnYmF0Y2gnLAogICAgZW50cnk6IGVudHJpZXMsCiAgfTsKICByZXR1cm4gYnVuZGxlOwp9CgpmdW5jdGlvbiBjcmVhdGVQYXRpZW50RW50cmllcygpOiBCdW5kbGVFbnRyeTxQYXRpZW50PltdIHsKICByZXR1cm4gWwogICAgewogICAgICBmdWxsVXJsOiAndXJuOnV1aWQ6YmQ5MGFmY2MtNGY0NC00YzEzLTg3MTAtODRkZGMxYmNlMzQ3JywKICAgICAgcmVxdWVzdDogeyBtZXRob2Q6ICdQVVQnLCB1cmw6ICdQYXRpZW50P25hbWU9aG9tZXInIH0sCiAgICAgIHJlc291cmNlOiB7CiAgICAgICAgcmVzb3VyY2VUeXBlOiAnUGF0aWVudCcsCiAgICAgICAgYWN0aXZlOiB0cnVlLAogICAgICAgIG5hbWU6IFt7IGZhbWlseTogJ1NpbXBzb24nLCBnaXZlbjogWydIb21lciddIH1dLAogICAgICAgIGdlbmRlcjogJ21hbGUnLAogICAgICAgIGJpcnRoRGF0ZTogJzE5NTYtMDUtMTInLAogICAgICB9LAogICAgfSwKICAgIHsKICAgICAgZnVsbFVybDogJ3Vybjp1dWlkOmVjYTY2MzUyLTQxNWMtNGRhYi1hZGQxLWU0ZWQ4YTE1NjQwOCcsCiAgICAgIHJlcXVlc3Q6IHsgbWV0aG9kOiAnUFVUJywgdXJsOiAnUGF0aWVudD9uYW1lPW1hcmdlJyB9LAogICAgICByZXNvdXJjZTogewogICAgICAgIHJlc291cmNlVHlwZTogJ1BhdGllbnQnLAogICAgICAgIGFjdGl2ZTogdHJ1ZSwKICAgICAgICBuYW1lOiBbeyBmYW1pbHk6ICdTaW1wc29uJywgZ2l2ZW46IFsnTWFyZ2UnXSB9XSwKICAgICAgICBnZW5kZXI6ICdmZW1hbGUnLAogICAgICAgIGJpcnRoRGF0ZTogJzE5NTgtMDMtMTknLAogICAgICB9LAogICAgfSwKICBdOwp9CgovLyBDcmVhdGUgc2xvdHMgYW5kIGFwcG9pbnRtZW50cyBmb3IgYSB3ZWVrCi8vIC0gQ3JlYXRlIGZyZWUgc2xvdHMgZm9yIE1vbmRheSBhbmQgV2VkbmVzZGF5Ci8vIC0gQ3JlYXRlIGFwcG9pbnRtZW50cyBmb3IgTW9uZGF5IGFuZCBXZWRuZXNkYXkKLy8gLSBDcmVhdGUgYSBidXN5LXVuYXZhaWxhYmxlIHNsb3QgZm9yIEZyaWRheQpmdW5jdGlvbiBjcmVhdGVXZWVrU2xvdHMoCiAgYmFzZURhdGU6IERhdGUsCiAgd2Vla09mZnNldDogbnVtYmVyLAogIGVudHJpZXM6IEJ1bmRsZUVudHJ5W10sCiAgc2NoZWR1bGVSZWZlcmVuY2U6IFJlZmVyZW5jZTxTY2hlZHVsZT4sCiAgcHJhY3RpdGlvbmVyUmVmZXJlbmNlOiBSZWZlcmVuY2U8UHJhY3RpdGlvbmVyPiwKICBwYXRpZW50UmVmZXJlbmNlczogW1JlZmVyZW5jZTxQYXRpZW50PiwgUmVmZXJlbmNlPFBhdGllbnQ+XQopOiB2b2lkIHsKICBjb25zdCBbcm91dGluZVBhdGllbnQsIGVtZXJnZW5jeVBhdGllbnRdID0gcGF0aWVudFJlZmVyZW5jZXM7CiAgLy8gQ2FsY3VsYXRlIE1vbmRheSwgV2VkbmVzZGF5LCBhbmQgRnJpZGF5IG9mIHRoZSB3ZWVrCiAgY29uc3QgbW9uZGF5ID0gbmV3IERhdGUoYmFzZURhdGUpOwogIG1vbmRheS5zZXREYXRlKG1vbmRheS5nZXREYXRlKCkgKyB3ZWVrT2Zmc2V0ICogNyAtICgoYmFzZURhdGUuZ2V0RGF5KCkgKyA2KSAlIDcpKTsKICBjb25zdCB3ZWRuZXNkYXkgPSBuZXcgRGF0ZShtb25kYXkpOwogIHdlZG5lc2RheS5zZXREYXRlKHdlZG5lc2RheS5nZXREYXRlKCkgKyAyKTsKICBjb25zdCBmcmlkYXkgPSBuZXcgRGF0ZShtb25kYXkpOwogIGZyaWRheS5zZXREYXRlKGZyaWRheS5nZXREYXRlKCkgKyA0KTsKCiAgLy8gQ3JlYXRlIGZyZWUgc2xvdHMgYW5kIGFwcG9pbnRtZW50cyBmb3IgTW9uZGF5IGFuZCBXZWRuZXNkYXkKICBbbW9uZGF5LCB3ZWRuZXNkYXldLmZvckVhY2goKGRheSwgaW5kZXgpID0+IHsKICAgIGZvciAobGV0IGhvdXIgPSA5OyBob3VyIDwgMTc7IGhvdXIrKykgewogICAgICAvLyBTa2lwIGx1bmNoIGhvdXIKICAgICAgaWYgKGhvdXIgPT09IDEyKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IG5ldyBEYXRlKGRheSk7CiAgICAgIHN0YXJ0VGltZS5zZXRIb3Vycyhob3VyLCAwLCAwLCAwKTsKICAgICAgY29uc3QgZW5kVGltZSA9IG5ldyBEYXRlKHN0YXJ0VGltZSk7CiAgICAgIGVuZFRpbWUuc2V0SG91cnMoaG91ciArIDEsIDAsIDAsIDApOwoKICAgICAgY29uc3QgZnJlZVNsb3RFbnRyeSA9IGNyZWF0ZVNsb3Qoc2NoZWR1bGVSZWZlcmVuY2UsIHN0YXJ0VGltZSwgZW5kVGltZSwgJ2ZyZWUnKTsKCiAgICAgIGlmICh3ZWVrT2Zmc2V0ID09PSAtMSAmJiBpbmRleCA9PT0gMCAmJiBob3VyID09PSA5KSB7CiAgICAgICAgLy8gQ3JlYXRlIGEgY2FuY2VsbGVkIHJvdXRpbmUgYXBwb2ludG1lbnQgb24gTW9uZGF5IGF0IDlhbSArIGEgcmVwbGFjZW1lbnQgZnJlZSBzbG90CiAgICAgICAgY29uc3QgYnVzeVNsb3RFbnRyeSA9IGNyZWF0ZVNsb3Qoc2NoZWR1bGVSZWZlcmVuY2UsIHN0YXJ0VGltZSwgZW5kVGltZSwgJ2J1c3knKTsKICAgICAgICBlbnRyaWVzLnB1c2goYnVzeVNsb3RFbnRyeSk7CiAgICAgICAgZW50cmllcy5wdXNoKAogICAgICAgICAgY3JlYXRlQXBwb2ludG1lbnQoCiAgICAgICAgICAgIHByYWN0aXRpb25lclJlZmVyZW5jZSwKICAgICAgICAgICAgcm91dGluZVBhdGllbnQsCiAgICAgICAgICAgIGJ1c3lTbG90RW50cnksCiAgICAgICAgICAgICdjYW5jZWxsZWQnLAogICAgICAgICAgICBhcHBvaW50bWVudFR5cGVNYXAucm91dGluZSwKICAgICAgICAgICAgW3NlcnZpY2VUeXBlTWFwLmNvbnN1bHRhdGlvbl0KICAgICAgICAgICkKICAgICAgICApOwogICAgICAgIGVudHJpZXMucHVzaChmcmVlU2xvdEVudHJ5KTsKICAgICAgfSBlbHNlIGlmICh3ZWVrT2Zmc2V0ID09PSAwICYmIGluZGV4ID09PSAwICYmIGhvdXIgPT09IDEwKSB7CiAgICAgICAgLy8gQ3JlYXRlIGEgZnVsZmlsbGVkIHJvdXRpbmUgYXBwb2ludG1lbnQgb24gTW9uZGF5IGF0IDEwYW0KICAgICAgICBjb25zdCBidXN5U2xvdEVudHJ5ID0gY3JlYXRlU2xvdChzY2hlZHVsZVJlZmVyZW5jZSwgc3RhcnRUaW1lLCBlbmRUaW1lLCAnYnVzeScpOwogICAgICAgIGVudHJpZXMucHVzaChidXN5U2xvdEVudHJ5KTsKICAgICAgICBjb25zdCBmdWxmaWxsZWRBcHBvaW50bWVudCA9IGNyZWF0ZUFwcG9pbnRtZW50KAogICAgICAgICAgcHJhY3RpdGlvbmVyUmVmZXJlbmNlLAogICAgICAgICAgcm91dGluZVBhdGllbnQsCiAgICAgICAgICBidXN5U2xvdEVudHJ5LAogICAgICAgICAgJ2Z1bGZpbGxlZCcsCiAgICAgICAgICBhcHBvaW50bWVudFR5cGVNYXAucm91dGluZSwKICAgICAgICAgIFtzZXJ2aWNlVHlwZU1hcC5jb25zdWx0YXRpb25dCiAgICAgICAgKTsKICAgICAgICBlbnRyaWVzLnB1c2goZnVsZmlsbGVkQXBwb2ludG1lbnQpOwogICAgICAgIGVudHJpZXMucHVzaChjcmVhdGVFbmNvdW50ZXIocHJhY3RpdGlvbmVyUmVmZXJlbmNlLCByb3V0aW5lUGF0aWVudCwgZnVsZmlsbGVkQXBwb2ludG1lbnQpKTsKICAgICAgfSBlbHNlIGlmICh3ZWVrT2Zmc2V0ID09PSAwICYmIGluZGV4ID09PSAxICYmIGhvdXIgPT09IDE1KSB7CiAgICAgICAgLy8gQ3JlYXRlIGFuIGVtZXJnZW5jeSBhcHBvaW50bWVudCBvbiBXZWRuZXNkYXkgYXQgM3BtCiAgICAgICAgY29uc3QgYnVzeVNsb3RFbnRyeSA9IGNyZWF0ZVNsb3Qoc2NoZWR1bGVSZWZlcmVuY2UsIHN0YXJ0VGltZSwgZW5kVGltZSwgJ2J1c3knKTsKICAgICAgICBlbnRyaWVzLnB1c2goYnVzeVNsb3RFbnRyeSk7CiAgICAgICAgZW50cmllcy5wdXNoKAogICAgICAgICAgY3JlYXRlQXBwb2ludG1lbnQoCiAgICAgICAgICAgIHByYWN0aXRpb25lclJlZmVyZW5jZSwKICAgICAgICAgICAgZW1lcmdlbmN5UGF0aWVudCwKICAgICAgICAgICAgYnVzeVNsb3RFbnRyeSwKICAgICAgICAgICAgJ2Jvb2tlZCcsCiAgICAgICAgICAgIGFwcG9pbnRtZW50VHlwZU1hcC5lbWVyZ2VuY3ksCiAgICAgICAgICAgIFtzZXJ2aWNlVHlwZU1hcC5lbWVyZ2VuY3lSb29tQWRtaXNzaW9uXQogICAgICAgICAgKQogICAgICAgICk7CiAgICAgIH0gZWxzZSBpZiAod2Vla09mZnNldCA9PT0gMSAmJiBpbmRleCA9PT0gMCAmJiBob3VyID09PSAxMSkgewogICAgICAgIC8vIENyZWF0ZSBhbiB1cGNvbWluZyBmb2xsb3d1cCBhcHBvaW50bWVudCBvbiBNb25kYXkgYXQgMTFhbQogICAgICAgIGNvbnN0IGJ1c3lTbG90RW50cnkgPSBjcmVhdGVTbG90KHNjaGVkdWxlUmVmZXJlbmNlLCBzdGFydFRpbWUsIGVuZFRpbWUsICdidXN5Jyk7CiAgICAgICAgZW50cmllcy5wdXNoKGJ1c3lTbG90RW50cnkpOwogICAgICAgIGVudHJpZXMucHVzaCgKICAgICAgICAgIGNyZWF0ZUFwcG9pbnRtZW50KAogICAgICAgICAgICBwcmFjdGl0aW9uZXJSZWZlcmVuY2UsCiAgICAgICAgICAgIHJvdXRpbmVQYXRpZW50LAogICAgICAgICAgICBidXN5U2xvdEVudHJ5LAogICAgICAgICAgICAnYm9va2VkJywKICAgICAgICAgICAgYXBwb2ludG1lbnRUeXBlTWFwLmZvbGxvd3VwLAogICAgICAgICAgICBbc2VydmljZVR5cGVNYXAuY29uc3VsdGF0aW9uXSwKICAgICAgICAgICAgJ0ZvbGxvd3VwIGFwcG9pbnRtZW50IHRvIGFzc2VzcyB0aGUgZXhhbSByZXN1bHRzJwogICAgICAgICAgKQogICAgICAgICk7CiAgICAgIH0gZWxzZSBpZiAod2Vla09mZnNldCA9PT0gMSAmJiBpbmRleCA9PT0gMSAmJiBob3VyID09PSAxNSkgewogICAgICAgIC8vIENyZWF0ZSBhbiB1cGNvbWluZyByb3V0aW5lIGNoZWNrdXAgYXBwb2ludG1lbnQgb24gV2VkbmVzZGF5IGF0IDNwbQogICAgICAgIGNvbnN0IGJ1c3lTbG90RW50cnkgPSBjcmVhdGVTbG90KHNjaGVkdWxlUmVmZXJlbmNlLCBzdGFydFRpbWUsIGVuZFRpbWUsICdidXN5Jyk7CiAgICAgICAgZW50cmllcy5wdXNoKGJ1c3lTbG90RW50cnkpOwogICAgICAgIGVudHJpZXMucHVzaCgKICAgICAgICAgIGNyZWF0ZUFwcG9pbnRtZW50KAogICAgICAgICAgICBwcmFjdGl0aW9uZXJSZWZlcmVuY2UsCiAgICAgICAgICAgIGVtZXJnZW5jeVBhdGllbnQsCiAgICAgICAgICAgIGJ1c3lTbG90RW50cnksCiAgICAgICAgICAgICdib29rZWQnLAogICAgICAgICAgICBhcHBvaW50bWVudFR5cGVNYXAucm91dGluZSwKICAgICAgICAgICAgW3NlcnZpY2VUeXBlTWFwLmNvbnN1bHRhdGlvbl0sCiAgICAgICAgICAgICdSb3V0aW5lIGNoZWNrdXAgYWZ0ZXIgdGhlIGVtZXJnZW5jeSByb29tIHZpc2l0JwogICAgICAgICAgKQogICAgICAgICk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gQ3JlYXRlIGEgZnJlZSBzbG90CiAgICAgICAgZW50cmllcy5wdXNoKGZyZWVTbG90RW50cnkpOwogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIENyZWF0ZSBidXN5LXVuYXZhaWxhYmxlIHNsb3QgZm9yIEZyaWRheSBmcm9tIDlhbSB0byA1cG0KICBjb25zdCBidXN5VW5hdmFpbGFibGVTbG90ID0gY3JlYXRlU2xvdCgKICAgIHNjaGVkdWxlUmVmZXJlbmNlLAogICAgbmV3IERhdGUobmV3IERhdGUoZnJpZGF5KS5zZXRIb3Vycyg5LCAwLCAwLCAwKSksCiAgICBuZXcgRGF0ZShuZXcgRGF0ZShmcmlkYXkpLnNldEhvdXJzKDE3LCAwLCAwLCAwKSksCiAgICAnYnVzeS11bmF2YWlsYWJsZScKICApOwogIGVudHJpZXMucHVzaChidXN5VW5hdmFpbGFibGVTbG90KTsKfQoKZnVuY3Rpb24gY3JlYXRlU2xvdChzY2hlZHVsZTogUmVmZXJlbmNlPFNjaGVkdWxlPiwgc3RhcnQ6IERhdGUsIGVuZDogRGF0ZSwgc3RhdHVzOiBTbG90WydzdGF0dXMnXSk6IEJ1bmRsZUVudHJ5PFNsb3Q+IHsKICByZXR1cm4gewogICAgZnVsbFVybDogYHVybjp1dWlkOiR7cmFuZG9tVVVJRCgpfWAsCiAgICByZXF1ZXN0OiB7IHVybDogJ1Nsb3QnLCBtZXRob2Q6ICdQT1NUJyB9LAogICAgcmVzb3VyY2U6IHsKICAgICAgcmVzb3VyY2VUeXBlOiAnU2xvdCcsCiAgICAgIHNjaGVkdWxlLAogICAgICBzdGF0dXMsCiAgICAgIHN0YXJ0OiBzdGFydC50b0lTT1N0cmluZygpLAogICAgICBlbmQ6IGVuZC50b0lTT1N0cmluZygpLAogICAgfSwKICB9Owp9CgpmdW5jdGlvbiBjcmVhdGVBcHBvaW50bWVudCgKICBwcmFjdGl0aW9uZXI6IFJlZmVyZW5jZTxQcmFjdGl0aW9uZXI+LAogIHBhdGllbnQ6IFJlZmVyZW5jZTxQYXRpZW50PiwKICBzbG90RW50cnk6IEJ1bmRsZUVudHJ5PFNsb3Q+LAogIHN0YXR1czogQXBwb2ludG1lbnRbJ3N0YXR1cyddLAogIGFwcG9pbnRtZW50VHlwZTogQXBwb2ludG1lbnRbJ2FwcG9pbnRtZW50VHlwZSddLAogIHNlcnZpY2VUeXBlOiBBcHBvaW50bWVudFsnc2VydmljZVR5cGUnXSwKICBjb21tZW50PzogQXBwb2ludG1lbnRbJ2NvbW1lbnQnXQopOiBCdW5kbGVFbnRyeTxBcHBvaW50bWVudD4gewogIGNvbnN0IHNsb3QgPSBzbG90RW50cnkucmVzb3VyY2UgYXMgU2xvdDsKICBjb25zdCBzbG90UmVmZXJlbmNlID0geyByZWZlcmVuY2U6IHNsb3RFbnRyeS5mdWxsVXJsIH07CiAgY29uc3QgY2FuY2VsYXRpb25SZWFzb24gPQogICAgc3RhdHVzID09PSAnY2FuY2VsbGVkJwogICAgICA/IHsKICAgICAgICAgIGNvZGluZzogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgc3lzdGVtOiAnaHR0cDovL3Rlcm1pbm9sb2d5LmhsNy5vcmcvQ29kZVN5c3RlbS9hcHBvaW50bWVudC1jYW5jZWxsYXRpb24tcmVhc29uJywKICAgICAgICAgICAgICBjb2RlOiAncHJvdicsCiAgICAgICAgICAgICAgZGlzcGxheTogJ1Byb3ZpZGVyJywKICAgICAgICAgICAgfSwKICAgICAgICAgIF0sCiAgICAgICAgfQogICAgICA6IHVuZGVmaW5lZDsKICByZXR1cm4gewogICAgZnVsbFVybDogYHVybjp1dWlkOiR7cmFuZG9tVVVJRCgpfWAsCiAgICByZXF1ZXN0OiB7IHVybDogJ0FwcG9pbnRtZW50JywgbWV0aG9kOiAnUE9TVCcgfSwKICAgIHJlc291cmNlOiB7CiAgICAgIHJlc291cmNlVHlwZTogJ0FwcG9pbnRtZW50JywKICAgICAgc3RhdHVzLAogICAgICBzbG90OiBbc2xvdFJlZmVyZW5jZV0sCiAgICAgIHN0YXJ0OiBzbG90LnN0YXJ0LAogICAgICBlbmQ6IHNsb3QuZW5kLAogICAgICBhcHBvaW50bWVudFR5cGUsCiAgICAgIHNlcnZpY2VUeXBlLAogICAgICBwYXJ0aWNpcGFudDogWwogICAgICAgIHsgYWN0b3I6IHBhdGllbnQsIHN0YXR1czogJ2FjY2VwdGVkJyB9LAogICAgICAgIHsgYWN0b3I6IHByYWN0aXRpb25lciwgc3RhdHVzOiAnYWNjZXB0ZWQnIH0sCiAgICAgIF0sCiAgICAgIGNvbW1lbnQsCiAgICAgIGNhbmNlbGF0aW9uUmVhc29uLAogICAgfSwKICB9Owp9CgpmdW5jdGlvbiBjcmVhdGVFbmNvdW50ZXIoCiAgcHJhY3RpdGlvbmVyOiBSZWZlcmVuY2U8UHJhY3RpdGlvbmVyPiwKICBwYXRpZW50OiBSZWZlcmVuY2U8UGF0aWVudD4sCiAgYXBwb2ludG1lbnRFbnRyeTogQnVuZGxlRW50cnk8QXBwb2ludG1lbnQ+Cik6IEJ1bmRsZUVudHJ5PEVuY291bnRlcj4gewogIGNvbnN0IGFwcG9pbnRtZW50ID0gYXBwb2ludG1lbnRFbnRyeS5yZXNvdXJjZSBhcyBBcHBvaW50bWVudDsKICBjb25zdCBhcHBvaW50bWVudFJlZmVyZW5jZSA9IHsgcmVmZXJlbmNlOiBhcHBvaW50bWVudEVudHJ5LmZ1bGxVcmwgfTsKICBjb25zdCBkdXJhdGlvbiA9IG5ldyBEYXRlKGFwcG9pbnRtZW50LmVuZCBhcyBzdHJpbmcpLmdldFRpbWUoKSAtIG5ldyBEYXRlKGFwcG9pbnRtZW50LnN0YXJ0IGFzIHN0cmluZykuZ2V0VGltZSgpOwogIHJldHVybiB7CiAgICBmdWxsVXJsOiBgdXJuOnV1aWQ6JHtyYW5kb21VVUlEKCl9YCwKICAgIHJlcXVlc3Q6IHsgdXJsOiAnRW5jb3VudGVyJywgbWV0aG9kOiAnUE9TVCcgfSwKICAgIHJlc291cmNlOiB7CiAgICAgIHJlc291cmNlVHlwZTogJ0VuY291bnRlcicsCiAgICAgIHN0YXR1czogJ2ZpbmlzaGVkJywKICAgICAgc3ViamVjdDogcGF0aWVudCwKICAgICAgYXBwb2ludG1lbnQ6IFthcHBvaW50bWVudFJlZmVyZW5jZV0sCiAgICAgIGNsYXNzOiB7CiAgICAgICAgc3lzdGVtOiAnaHR0cDovL3Rlcm1pbm9sb2d5LmhsNy5vcmcvQ29kZVN5c3RlbS92My1BY3RDb2RlJywKICAgICAgICBjb2RlOiAnVlInLAogICAgICAgIGRpc3BsYXk6ICd2aXJ0dWFsJywKICAgICAgfSwKICAgICAgc2VydmljZVR5cGU6IGFwcG9pbnRtZW50LnNlcnZpY2VUeXBlPy5bMF0sCiAgICAgIHBlcmlvZDogewogICAgICAgIHN0YXJ0OiBhcHBvaW50bWVudC5zdGFydCwKICAgICAgICBlbmQ6IGFwcG9pbnRtZW50LmVuZCwKICAgICAgfSwKICAgICAgbGVuZ3RoOiB7CiAgICAgICAgdmFsdWU6IE1hdGguZmxvb3IoZHVyYXRpb24gLyA2MDAwMCksCiAgICAgICAgdW5pdDogJ21pbnV0ZXMnLAogICAgICB9LAogICAgICBwYXJ0aWNpcGFudDogWwogICAgICAgIHsKICAgICAgICAgIGluZGl2aWR1YWw6IHByYWN0aXRpb25lciwKICAgICAgICAgIHR5cGU6IFt7IGNvZGluZzogW3sgc3lzdGVtOiAnaHR0cDovL3Rlcm1pbm9sb2d5LmhsNy5vcmcvQ29kZVN5c3RlbS92My1QYXJ0aWNpcGF0aW9uVHlwZScsIGNvZGU6ICdBVE5EJyB9XSB9XSwKICAgICAgICB9LAogICAgICBdLAogICAgfSwKICB9Owp9CgovLyBTdWJzZXQgb2YgaHR0cDovL3Rlcm1pbm9sb2d5LmhsNy5vcmcvVmFsdWVTZXQvdjItMDI3Ngpjb25zdCBhcHBvaW50bWVudFR5cGVNYXA6IFJlY29yZDxzdHJpbmcsIENvZGVhYmxlQ29uY2VwdD4gPSB7CiAgZm9sbG93dXA6IHsKICAgIGNvZGluZzogWwogICAgICB7CiAgICAgICAgc3lzdGVtOiAnaHR0cDovL3Rlcm1pbm9sb2d5LmhsNy5vcmcvQ29kZVN5c3RlbS92Mi0wMjc2JywKICAgICAgICBjb2RlOiAnRk9MTE9XVVAnLAogICAgICAgIGRpc3BsYXk6ICdBIGZvbGxvdyB1cCB2aXNpdCBmcm9tIGEgcHJldmlvdXMgYXBwb2ludG1lbnQnLAogICAgICB9LAogICAgXSwKICB9LAogIHJvdXRpbmU6IHsKICAgIGNvZGluZzogWwogICAgICB7CiAgICAgICAgc3lzdGVtOiAnaHR0cDovL3Rlcm1pbm9sb2d5LmhsNy5vcmcvQ29kZVN5c3RlbS92Mi0wMjc2JywKICAgICAgICBjb2RlOiAnUk9VVElORScsCiAgICAgICAgZGlzcGxheTogJ1JvdXRpbmUgYXBwb2ludG1lbnQgLSBkZWZhdWx0IGlmIG5vdCB2YWx1ZWQnLAogICAgICB9LAogICAgXSwKICB9LAogIGVtZXJnZW5jeTogewogICAgY29kaW5nOiBbCiAgICAgIHsKICAgICAgICBzeXN0ZW06ICdodHRwOi8vdGVybWlub2xvZ3kuaGw3Lm9yZy9Db2RlU3lzdGVtL3YyLTAyNzYnLAogICAgICAgIGNvZGU6ICdFTUVSR0VOQ1knLAogICAgICAgIGRpc3BsYXk6ICdFbWVyZ2VuY3kgYXBwb2ludG1lbnQnLAogICAgICB9LAogICAgXSwKICB9LAp9OwoKLy8gU3Vic2V0IG9mIGh0dHA6Ly9leGFtcGxlLmNvbS9hcHBvaW50bWVudC1zZXJ2aWNlLXR5cGVzCmNvbnN0IHNlcnZpY2VUeXBlTWFwOiBSZWNvcmQ8c3RyaW5nLCBDb2RlYWJsZUNvbmNlcHQ+ID0gewogIGNvbnN1bHRhdGlvbjogewogICAgY29kaW5nOiBbCiAgICAgIHsKICAgICAgICBzeXN0ZW06ICdodHRwOi8vc25vbWVkLmluZm8vc2N0JywKICAgICAgICBjb2RlOiAnMTE0MjkwMDYnLAogICAgICAgIGRpc3BsYXk6ICdDb25zdWx0YXRpb24nLAogICAgICB9LAogICAgXSwKICB9LAogIGVtZXJnZW5jeVJvb21BZG1pc3Npb246IHsKICAgIGNvZGluZzogWwogICAgICB7CiAgICAgICAgc3lzdGVtOiAnaHR0cDovL3Nub21lZC5pbmZvL3NjdCcsCiAgICAgICAgY29kZTogJzUwODQ5MDAyJywKICAgICAgICBkaXNwbGF5OiAnRW1lcmdlbmN5IHJvb20gYWRtaXNzaW9uJywKICAgICAgfSwKICAgIF0sCiAgfSwKfTsK"
      }
    },
    {
      "fullUrl": "urn:uuid:64acdec2-3e9f-45fb-a0ad-f666da7c7234",
      "request": {
        "method": "POST",
        "url": "Binary"
      },
      "resource": {
        "resourceType": "Binary",
        "contentType": "text/javascript",
        "data": "InVzZSBzdHJpY3QiOwp2YXIgX19kZWZQcm9wID0gT2JqZWN0LmRlZmluZVByb3BlcnR5Owp2YXIgX19nZXRPd25Qcm9wRGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I7CnZhciBfX2dldE93blByb3BOYW1lcyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzOwp2YXIgX19oYXNPd25Qcm9wID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTsKdmFyIF9fZXhwb3J0ID0gKHRhcmdldCwgYWxsKSA9PiB7CiAgZm9yICh2YXIgbmFtZSBpbiBhbGwpCiAgICBfX2RlZlByb3AodGFyZ2V0LCBuYW1lLCB7IGdldDogYWxsW25hbWVdLCBlbnVtZXJhYmxlOiB0cnVlIH0pOwp9Owp2YXIgX19jb3B5UHJvcHMgPSAodG8sIGZyb20sIGV4Y2VwdCwgZGVzYykgPT4gewogIGlmIChmcm9tICYmIHR5cGVvZiBmcm9tID09PSAib2JqZWN0IiB8fCB0eXBlb2YgZnJvbSA9PT0gImZ1bmN0aW9uIikgewogICAgZm9yIChsZXQga2V5IG9mIF9fZ2V0T3duUHJvcE5hbWVzKGZyb20pKQogICAgICBpZiAoIV9faGFzT3duUHJvcC5jYWxsKHRvLCBrZXkpICYmIGtleSAhPT0gZXhjZXB0KQogICAgICAgIF9fZGVmUHJvcCh0bywga2V5LCB7IGdldDogKCkgPT4gZnJvbVtrZXldLCBlbnVtZXJhYmxlOiAhKGRlc2MgPSBfX2dldE93blByb3BEZXNjKGZyb20sIGtleSkpIHx8IGRlc2MuZW51bWVyYWJsZSB9KTsKICB9CiAgcmV0dXJuIHRvOwp9Owp2YXIgX190b0NvbW1vbkpTID0gKG1vZCkgPT4gX19jb3B5UHJvcHMoX19kZWZQcm9wKHt9LCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSksIG1vZCk7CgovLyBzcmMvYm90cy9leGFtcGxlL2V4YW1wbGUtZGF0YS50cwp2YXIgZXhhbXBsZV9kYXRhX2V4cG9ydHMgPSB7fTsKX19leHBvcnQoZXhhbXBsZV9kYXRhX2V4cG9ydHMsIHsKICBoYW5kbGVyOiAoKSA9PiBoYW5kbGVyCn0pOwptb2R1bGUuZXhwb3J0cyA9IF9fdG9Db21tb25KUyhleGFtcGxlX2RhdGFfZXhwb3J0cyk7CnZhciBpbXBvcnRfY29yZSA9IHJlcXVpcmUoIkBtZWRwbHVtL2NvcmUiKTsKdmFyIGltcG9ydF9jcnlwdG8gPSByZXF1aXJlKCJjcnlwdG8iKTsKYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihtZWRwbHVtLCBldmVudCkgewogIGNvbnN0IHByYWN0aXRpb25lciA9IGV2ZW50LmlucHV0OwogIGNvbnN0IHNjaGVkdWxlID0gYXdhaXQgbWVkcGx1bS5zZWFyY2hPbmUoIlNjaGVkdWxlIiwgeyBhY3RvcjogKDAsIGltcG9ydF9jb3JlLmdldFJlZmVyZW5jZVN0cmluZykocHJhY3RpdGlvbmVyKSB9KTsKICBpZiAoIXNjaGVkdWxlKSB7CiAgICB0aHJvdyBuZXcgRXJyb3IoIlNjaGVkdWxlIG5vdCBmb3VuZCIpOwogIH0KICBjb25zdCBlbnRyaWVzID0gWy4uLmNyZWF0ZVBhdGllbnRFbnRyaWVzKCldOwogIGNvbnN0IHByYWN0aXRpb25lclJlZmVyZW5jZSA9ICgwLCBpbXBvcnRfY29yZS5jcmVhdGVSZWZlcmVuY2UpKHByYWN0aXRpb25lcik7CiAgY29uc3QgaG9tZXJSZWZlcmVuY2UgPSB7IHJlZmVyZW5jZTogInVybjp1dWlkOmJkOTBhZmNjLTRmNDQtNGMxMy04NzEwLTg0ZGRjMWJjZTM0NyIsIGRpc3BsYXk6ICJIb21lciBTaW1wc29uIiB9OwogIGNvbnN0IG1hcmdlUmVmZXJlbmNlID0geyByZWZlcmVuY2U6ICJ1cm46dXVpZDplY2E2NjM1Mi00MTVjLTRkYWItYWRkMS1lNGVkOGExNTY0MDgiLCBkaXNwbGF5OiAiTWFyZ2UgU2ltcHNvbiIgfTsKICBjb25zdCBzY2hlZHVsZVJlZmVyZW5jZSA9ICgwLCBpbXBvcnRfY29yZS5jcmVhdGVSZWZlcmVuY2UpKHNjaGVkdWxlKTsKICBjb25zdCB0b2RheSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpOwogIGNyZWF0ZVdlZWtTbG90cyh0b2RheSwgLTEsIGVudHJpZXMsIHNjaGVkdWxlUmVmZXJlbmNlLCBwcmFjdGl0aW9uZXJSZWZlcmVuY2UsIFttYXJnZVJlZmVyZW5jZSwgaG9tZXJSZWZlcmVuY2VdKTsKICBjcmVhdGVXZWVrU2xvdHModG9kYXksIDAsIGVudHJpZXMsIHNjaGVkdWxlUmVmZXJlbmNlLCBwcmFjdGl0aW9uZXJSZWZlcmVuY2UsIFttYXJnZVJlZmVyZW5jZSwgaG9tZXJSZWZlcmVuY2VdKTsKICBjcmVhdGVXZWVrU2xvdHModG9kYXksIDEsIGVudHJpZXMsIHNjaGVkdWxlUmVmZXJlbmNlLCBwcmFjdGl0aW9uZXJSZWZlcmVuY2UsIFttYXJnZVJlZmVyZW5jZSwgaG9tZXJSZWZlcmVuY2VdKTsKICBjb25zdCBidW5kbGUgPSB7CiAgICByZXNvdXJjZVR5cGU6ICJCdW5kbGUiLAogICAgdHlwZTogImJhdGNoIiwKICAgIGVudHJ5OiBlbnRyaWVzCiAgfTsKICByZXR1cm4gYnVuZGxlOwp9CmZ1bmN0aW9uIGNyZWF0ZVBhdGllbnRFbnRyaWVzKCkgewogIHJldHVybiBbCiAgICB7CiAgICAgIGZ1bGxVcmw6ICJ1cm46dXVpZDpiZDkwYWZjYy00ZjQ0LTRjMTMtODcxMC04NGRkYzFiY2UzNDciLAogICAgICByZXF1ZXN0OiB7IG1ldGhvZDogIlBVVCIsIHVybDogIlBhdGllbnQ/bmFtZT1ob21lciIgfSwKICAgICAgcmVzb3VyY2U6IHsKICAgICAgICByZXNvdXJjZVR5cGU6ICJQYXRpZW50IiwKICAgICAgICBhY3RpdmU6IHRydWUsCiAgICAgICAgbmFtZTogW3sgZmFtaWx5OiAiU2ltcHNvbiIsIGdpdmVuOiBbIkhvbWVyIl0gfV0sCiAgICAgICAgZ2VuZGVyOiAibWFsZSIsCiAgICAgICAgYmlydGhEYXRlOiAiMTk1Ni0wNS0xMiIKICAgICAgfQogICAgfSwKICAgIHsKICAgICAgZnVsbFVybDogInVybjp1dWlkOmVjYTY2MzUyLTQxNWMtNGRhYi1hZGQxLWU0ZWQ4YTE1NjQwOCIsCiAgICAgIHJlcXVlc3Q6IHsgbWV0aG9kOiAiUFVUIiwgdXJsOiAiUGF0aWVudD9uYW1lPW1hcmdlIiB9LAogICAgICByZXNvdXJjZTogewogICAgICAgIHJlc291cmNlVHlwZTogIlBhdGllbnQiLAogICAgICAgIGFjdGl2ZTogdHJ1ZSwKICAgICAgICBuYW1lOiBbeyBmYW1pbHk6ICJTaW1wc29uIiwgZ2l2ZW46IFsiTWFyZ2UiXSB9XSwKICAgICAgICBnZW5kZXI6ICJmZW1hbGUiLAogICAgICAgIGJpcnRoRGF0ZTogIjE5NTgtMDMtMTkiCiAgICAgIH0KICAgIH0KICBdOwp9CmZ1bmN0aW9uIGNyZWF0ZVdlZWtTbG90cyhiYXNlRGF0ZSwgd2Vla09mZnNldCwgZW50cmllcywgc2NoZWR1bGVSZWZlcmVuY2UsIHByYWN0aXRpb25lclJlZmVyZW5jZSwgcGF0aWVudFJlZmVyZW5jZXMpIHsKICBjb25zdCBbcm91dGluZVBhdGllbnQsIGVtZXJnZW5jeVBhdGllbnRdID0gcGF0aWVudFJlZmVyZW5jZXM7CiAgY29uc3QgbW9uZGF5ID0gbmV3IERhdGUoYmFzZURhdGUpOwogIG1vbmRheS5zZXREYXRlKG1vbmRheS5nZXREYXRlKCkgKyB3ZWVrT2Zmc2V0ICogNyAtIChiYXNlRGF0ZS5nZXREYXkoKSArIDYpICUgNyk7CiAgY29uc3Qgd2VkbmVzZGF5ID0gbmV3IERhdGUobW9uZGF5KTsKICB3ZWRuZXNkYXkuc2V0RGF0ZSh3ZWRuZXNkYXkuZ2V0RGF0ZSgpICsgMik7CiAgY29uc3QgZnJpZGF5ID0gbmV3IERhdGUobW9uZGF5KTsKICBmcmlkYXkuc2V0RGF0ZShmcmlkYXkuZ2V0RGF0ZSgpICsgNCk7CiAgW21vbmRheSwgd2VkbmVzZGF5XS5mb3JFYWNoKChkYXksIGluZGV4KSA9PiB7CiAgICBmb3IgKGxldCBob3VyID0gOTsgaG91ciA8IDE3OyBob3VyKyspIHsKICAgICAgaWYgKGhvdXIgPT09IDEyKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KICAgICAgY29uc3Qgc3RhcnRUaW1lID0gbmV3IERhdGUoZGF5KTsKICAgICAgc3RhcnRUaW1lLnNldEhvdXJzKGhvdXIsIDAsIDAsIDApOwogICAgICBjb25zdCBlbmRUaW1lID0gbmV3IERhdGUoc3RhcnRUaW1lKTsKICAgICAgZW5kVGltZS5zZXRIb3Vycyhob3VyICsgMSwgMCwgMCwgMCk7CiAgICAgIGNvbnN0IGZyZWVTbG90RW50cnkgPSBjcmVhdGVTbG90KHNjaGVkdWxlUmVmZXJlbmNlLCBzdGFydFRpbWUsIGVuZFRpbWUsICJmcmVlIik7CiAgICAgIGlmICh3ZWVrT2Zmc2V0ID09PSAtMSAmJiBpbmRleCA9PT0gMCAmJiBob3VyID09PSA5KSB7CiAgICAgICAgY29uc3QgYnVzeVNsb3RFbnRyeSA9IGNyZWF0ZVNsb3Qoc2NoZWR1bGVSZWZlcmVuY2UsIHN0YXJ0VGltZSwgZW5kVGltZSwgImJ1c3kiKTsKICAgICAgICBlbnRyaWVzLnB1c2goYnVzeVNsb3RFbnRyeSk7CiAgICAgICAgZW50cmllcy5wdXNoKAogICAgICAgICAgY3JlYXRlQXBwb2ludG1lbnQoCiAgICAgICAgICAgIHByYWN0aXRpb25lclJlZmVyZW5jZSwKICAgICAgICAgICAgcm91dGluZVBhdGllbnQsCiAgICAgICAgICAgIGJ1c3lTbG90RW50cnksCiAgICAgICAgICAgICJjYW5jZWxsZWQiLAogICAgICAgICAgICBhcHBvaW50bWVudFR5cGVNYXAucm91dGluZSwKICAgICAgICAgICAgW3NlcnZpY2VUeXBlTWFwLmNvbnN1bHRhdGlvbl0KICAgICAgICAgICkKICAgICAgICApOwogICAgICAgIGVudHJpZXMucHVzaChmcmVlU2xvdEVudHJ5KTsKICAgICAgfSBlbHNlIGlmICh3ZWVrT2Zmc2V0ID09PSAwICYmIGluZGV4ID09PSAwICYmIGhvdXIgPT09IDEwKSB7CiAgICAgICAgY29uc3QgYnVzeVNsb3RFbnRyeSA9IGNyZWF0ZVNsb3Qoc2NoZWR1bGVSZWZlcmVuY2UsIHN0YXJ0VGltZSwgZW5kVGltZSwgImJ1c3kiKTsKICAgICAgICBlbnRyaWVzLnB1c2goYnVzeVNsb3RFbnRyeSk7CiAgICAgICAgY29uc3QgZnVsZmlsbGVkQXBwb2ludG1lbnQgPSBjcmVhdGVBcHBvaW50bWVudCgKICAgICAgICAgIHByYWN0aXRpb25lclJlZmVyZW5jZSwKICAgICAgICAgIHJvdXRpbmVQYXRpZW50LAogICAgICAgICAgYnVzeVNsb3RFbnRyeSwKICAgICAgICAgICJmdWxmaWxsZWQiLAogICAgICAgICAgYXBwb2ludG1lbnRUeXBlTWFwLnJvdXRpbmUsCiAgICAgICAgICBbc2VydmljZVR5cGVNYXAuY29uc3VsdGF0aW9uXQogICAgICAgICk7CiAgICAgICAgZW50cmllcy5wdXNoKGZ1bGZpbGxlZEFwcG9pbnRtZW50KTsKICAgICAgICBlbnRyaWVzLnB1c2goY3JlYXRlRW5jb3VudGVyKHByYWN0aXRpb25lclJlZmVyZW5jZSwgcm91dGluZVBhdGllbnQsIGZ1bGZpbGxlZEFwcG9pbnRtZW50KSk7CiAgICAgIH0gZWxzZSBpZiAod2Vla09mZnNldCA9PT0gMCAmJiBpbmRleCA9PT0gMSAmJiBob3VyID09PSAxNSkgewogICAgICAgIGNvbnN0IGJ1c3lTbG90RW50cnkgPSBjcmVhdGVTbG90KHNjaGVkdWxlUmVmZXJlbmNlLCBzdGFydFRpbWUsIGVuZFRpbWUsICJidXN5Iik7CiAgICAgICAgZW50cmllcy5wdXNoKGJ1c3lTbG90RW50cnkpOwogICAgICAgIGVudHJpZXMucHVzaCgKICAgICAgICAgIGNyZWF0ZUFwcG9pbnRtZW50KAogICAgICAgICAgICBwcmFjdGl0aW9uZXJSZWZlcmVuY2UsCiAgICAgICAgICAgIGVtZXJnZW5jeVBhdGllbnQsCiAgICAgICAgICAgIGJ1c3lTbG90RW50cnksCiAgICAgICAgICAgICJib29rZWQiLAogICAgICAgICAgICBhcHBvaW50bWVudFR5cGVNYXAuZW1lcmdlbmN5LAogICAgICAgICAgICBbc2VydmljZVR5cGVNYXAuZW1lcmdlbmN5Um9vbUFkbWlzc2lvbl0KICAgICAgICAgICkKICAgICAgICApOwogICAgICB9IGVsc2UgaWYgKHdlZWtPZmZzZXQgPT09IDEgJiYgaW5kZXggPT09IDAgJiYgaG91ciA9PT0gMTEpIHsKICAgICAgICBjb25zdCBidXN5U2xvdEVudHJ5ID0gY3JlYXRlU2xvdChzY2hlZHVsZVJlZmVyZW5jZSwgc3RhcnRUaW1lLCBlbmRUaW1lLCAiYnVzeSIpOwogICAgICAgIGVudHJpZXMucHVzaChidXN5U2xvdEVudHJ5KTsKICAgICAgICBlbnRyaWVzLnB1c2goCiAgICAgICAgICBjcmVhdGVBcHBvaW50bWVudCgKICAgICAgICAgICAgcHJhY3RpdGlvbmVyUmVmZXJlbmNlLAogICAgICAgICAgICByb3V0aW5lUGF0aWVudCwKICAgICAgICAgICAgYnVzeVNsb3RFbnRyeSwKICAgICAgICAgICAgImJvb2tlZCIsCiAgICAgICAgICAgIGFwcG9pbnRtZW50VHlwZU1hcC5mb2xsb3d1cCwKICAgICAgICAgICAgW3NlcnZpY2VUeXBlTWFwLmNvbnN1bHRhdGlvbl0sCiAgICAgICAgICAgICJGb2xsb3d1cCBhcHBvaW50bWVudCB0byBhc3Nlc3MgdGhlIGV4YW0gcmVzdWx0cyIKICAgICAgICAgICkKICAgICAgICApOwogICAgICB9IGVsc2UgaWYgKHdlZWtPZmZzZXQgPT09IDEgJiYgaW5kZXggPT09IDEgJiYgaG91ciA9PT0gMTUpIHsKICAgICAgICBjb25zdCBidXN5U2xvdEVudHJ5ID0gY3JlYXRlU2xvdChzY2hlZHVsZVJlZmVyZW5jZSwgc3RhcnRUaW1lLCBlbmRUaW1lLCAiYnVzeSIpOwogICAgICAgIGVudHJpZXMucHVzaChidXN5U2xvdEVudHJ5KTsKICAgICAgICBlbnRyaWVzLnB1c2goCiAgICAgICAgICBjcmVhdGVBcHBvaW50bWVudCgKICAgICAgICAgICAgcHJhY3RpdGlvbmVyUmVmZXJlbmNlLAogICAgICAgICAgICBlbWVyZ2VuY3lQYXRpZW50LAogICAgICAgICAgICBidXN5U2xvdEVudHJ5LAogICAgICAgICAgICAiYm9va2VkIiwKICAgICAgICAgICAgYXBwb2ludG1lbnRUeXBlTWFwLnJvdXRpbmUsCiAgICAgICAgICAgIFtzZXJ2aWNlVHlwZU1hcC5jb25zdWx0YXRpb25dLAogICAgICAgICAgICAiUm91dGluZSBjaGVja3VwIGFmdGVyIHRoZSBlbWVyZ2VuY3kgcm9vbSB2aXNpdCIKICAgICAgICAgICkKICAgICAgICApOwogICAgICB9IGVsc2UgewogICAgICAgIGVudHJpZXMucHVzaChmcmVlU2xvdEVudHJ5KTsKICAgICAgfQogICAgfQogIH0pOwogIGNvbnN0IGJ1c3lVbmF2YWlsYWJsZVNsb3QgPSBjcmVhdGVTbG90KAogICAgc2NoZWR1bGVSZWZlcmVuY2UsCiAgICBuZXcgRGF0ZShuZXcgRGF0ZShmcmlkYXkpLnNldEhvdXJzKDksIDAsIDAsIDApKSwKICAgIG5ldyBEYXRlKG5ldyBEYXRlKGZyaWRheSkuc2V0SG91cnMoMTcsIDAsIDAsIDApKSwKICAgICJidXN5LXVuYXZhaWxhYmxlIgogICk7CiAgZW50cmllcy5wdXNoKGJ1c3lVbmF2YWlsYWJsZVNsb3QpOwp9CmZ1bmN0aW9uIGNyZWF0ZVNsb3Qoc2NoZWR1bGUsIHN0YXJ0LCBlbmQsIHN0YXR1cykgewogIHJldHVybiB7CiAgICBmdWxsVXJsOiBgdXJuOnV1aWQ6JHsoMCwgaW1wb3J0X2NyeXB0by5yYW5kb21VVUlEKSgpfWAsCiAgICByZXF1ZXN0OiB7IHVybDogIlNsb3QiLCBtZXRob2Q6ICJQT1NUIiB9LAogICAgcmVzb3VyY2U6IHsKICAgICAgcmVzb3VyY2VUeXBlOiAiU2xvdCIsCiAgICAgIHNjaGVkdWxlLAogICAgICBzdGF0dXMsCiAgICAgIHN0YXJ0OiBzdGFydC50b0lTT1N0cmluZygpLAogICAgICBlbmQ6IGVuZC50b0lTT1N0cmluZygpCiAgICB9CiAgfTsKfQpmdW5jdGlvbiBjcmVhdGVBcHBvaW50bWVudChwcmFjdGl0aW9uZXIsIHBhdGllbnQsIHNsb3RFbnRyeSwgc3RhdHVzLCBhcHBvaW50bWVudFR5cGUsIHNlcnZpY2VUeXBlLCBjb21tZW50KSB7CiAgY29uc3Qgc2xvdCA9IHNsb3RFbnRyeS5yZXNvdXJjZTsKICBjb25zdCBzbG90UmVmZXJlbmNlID0geyByZWZlcmVuY2U6IHNsb3RFbnRyeS5mdWxsVXJsIH07CiAgY29uc3QgY2FuY2VsYXRpb25SZWFzb24gPSBzdGF0dXMgPT09ICJjYW5jZWxsZWQiID8gewogICAgY29kaW5nOiBbCiAgICAgIHsKICAgICAgICBzeXN0ZW06ICJodHRwOi8vdGVybWlub2xvZ3kuaGw3Lm9yZy9Db2RlU3lzdGVtL2FwcG9pbnRtZW50LWNhbmNlbGxhdGlvbi1yZWFzb24iLAogICAgICAgIGNvZGU6ICJwcm92IiwKICAgICAgICBkaXNwbGF5OiAiUHJvdmlkZXIiCiAgICAgIH0KICAgIF0KICB9IDogdm9pZCAwOwogIHJldHVybiB7CiAgICBmdWxsVXJsOiBgdXJuOnV1aWQ6JHsoMCwgaW1wb3J0X2NyeXB0by5yYW5kb21VVUlEKSgpfWAsCiAgICByZXF1ZXN0OiB7IHVybDogIkFwcG9pbnRtZW50IiwgbWV0aG9kOiAiUE9TVCIgfSwKICAgIHJlc291cmNlOiB7CiAgICAgIHJlc291cmNlVHlwZTogIkFwcG9pbnRtZW50IiwKICAgICAgc3RhdHVzLAogICAgICBzbG90OiBbc2xvdFJlZmVyZW5jZV0sCiAgICAgIHN0YXJ0OiBzbG90LnN0YXJ0LAogICAgICBlbmQ6IHNsb3QuZW5kLAogICAgICBhcHBvaW50bWVudFR5cGUsCiAgICAgIHNlcnZpY2VUeXBlLAogICAgICBwYXJ0aWNpcGFudDogWwogICAgICAgIHsgYWN0b3I6IHBhdGllbnQsIHN0YXR1czogImFjY2VwdGVkIiB9LAogICAgICAgIHsgYWN0b3I6IHByYWN0aXRpb25lciwgc3RhdHVzOiAiYWNjZXB0ZWQiIH0KICAgICAgXSwKICAgICAgY29tbWVudCwKICAgICAgY2FuY2VsYXRpb25SZWFzb24KICAgIH0KICB9Owp9CmZ1bmN0aW9uIGNyZWF0ZUVuY291bnRlcihwcmFjdGl0aW9uZXIsIHBhdGllbnQsIGFwcG9pbnRtZW50RW50cnkpIHsKICBjb25zdCBhcHBvaW50bWVudCA9IGFwcG9pbnRtZW50RW50cnkucmVzb3VyY2U7CiAgY29uc3QgYXBwb2ludG1lbnRSZWZlcmVuY2UgPSB7IHJlZmVyZW5jZTogYXBwb2ludG1lbnRFbnRyeS5mdWxsVXJsIH07CiAgY29uc3QgZHVyYXRpb24gPSBuZXcgRGF0ZShhcHBvaW50bWVudC5lbmQpLmdldFRpbWUoKSAtIG5ldyBEYXRlKGFwcG9pbnRtZW50LnN0YXJ0KS5nZXRUaW1lKCk7CiAgcmV0dXJuIHsKICAgIGZ1bGxVcmw6IGB1cm46dXVpZDokeygwLCBpbXBvcnRfY3J5cHRvLnJhbmRvbVVVSUQpKCl9YCwKICAgIHJlcXVlc3Q6IHsgdXJsOiAiRW5jb3VudGVyIiwgbWV0aG9kOiAiUE9TVCIgfSwKICAgIHJlc291cmNlOiB7CiAgICAgIHJlc291cmNlVHlwZTogIkVuY291bnRlciIsCiAgICAgIHN0YXR1czogImZpbmlzaGVkIiwKICAgICAgc3ViamVjdDogcGF0aWVudCwKICAgICAgYXBwb2ludG1lbnQ6IFthcHBvaW50bWVudFJlZmVyZW5jZV0sCiAgICAgIGNsYXNzOiB7CiAgICAgICAgc3lzdGVtOiAiaHR0cDovL3Rlcm1pbm9sb2d5LmhsNy5vcmcvQ29kZVN5c3RlbS92My1BY3RDb2RlIiwKICAgICAgICBjb2RlOiAiVlIiLAogICAgICAgIGRpc3BsYXk6ICJ2aXJ0dWFsIgogICAgICB9LAogICAgICBzZXJ2aWNlVHlwZTogYXBwb2ludG1lbnQuc2VydmljZVR5cGU/LlswXSwKICAgICAgcGVyaW9kOiB7CiAgICAgICAgc3RhcnQ6IGFwcG9pbnRtZW50LnN0YXJ0LAogICAgICAgIGVuZDogYXBwb2ludG1lbnQuZW5kCiAgICAgIH0sCiAgICAgIGxlbmd0aDogewogICAgICAgIHZhbHVlOiBNYXRoLmZsb29yKGR1cmF0aW9uIC8gNmU0KSwKICAgICAgICB1bml0OiAibWludXRlcyIKICAgICAgfSwKICAgICAgcGFydGljaXBhbnQ6IFsKICAgICAgICB7CiAgICAgICAgICBpbmRpdmlkdWFsOiBwcmFjdGl0aW9uZXIsCiAgICAgICAgICB0eXBlOiBbeyBjb2Rpbmc6IFt7IHN5c3RlbTogImh0dHA6Ly90ZXJtaW5vbG9neS5obDcub3JnL0NvZGVTeXN0ZW0vdjMtUGFydGljaXBhdGlvblR5cGUiLCBjb2RlOiAiQVRORCIgfV0gfV0KICAgICAgICB9CiAgICAgIF0KICAgIH0KICB9Owp9CnZhciBhcHBvaW50bWVudFR5cGVNYXAgPSB7CiAgZm9sbG93dXA6IHsKICAgIGNvZGluZzogWwogICAgICB7CiAgICAgICAgc3lzdGVtOiAiaHR0cDovL3Rlcm1pbm9sb2d5LmhsNy5vcmcvQ29kZVN5c3RlbS92Mi0wMjc2IiwKICAgICAgICBjb2RlOiAiRk9MTE9XVVAiLAogICAgICAgIGRpc3BsYXk6ICJBIGZvbGxvdyB1cCB2aXNpdCBmcm9tIGEgcHJldmlvdXMgYXBwb2ludG1lbnQiCiAgICAgIH0KICAgIF0KICB9LAogIHJvdXRpbmU6IHsKICAgIGNvZGluZzogWwogICAgICB7CiAgICAgICAgc3lzdGVtOiAiaHR0cDovL3Rlcm1pbm9sb2d5LmhsNy5vcmcvQ29kZVN5c3RlbS92Mi0wMjc2IiwKICAgICAgICBjb2RlOiAiUk9VVElORSIsCiAgICAgICAgZGlzcGxheTogIlJvdXRpbmUgYXBwb2ludG1lbnQgLSBkZWZhdWx0IGlmIG5vdCB2YWx1ZWQiCiAgICAgIH0KICAgIF0KICB9LAogIGVtZXJnZW5jeTogewogICAgY29kaW5nOiBbCiAgICAgIHsKICAgICAgICBzeXN0ZW06ICJodHRwOi8vdGVybWlub2xvZ3kuaGw3Lm9yZy9Db2RlU3lzdGVtL3YyLTAyNzYiLAogICAgICAgIGNvZGU6ICJFTUVSR0VOQ1kiLAogICAgICAgIGRpc3BsYXk6ICJFbWVyZ2VuY3kgYXBwb2ludG1lbnQiCiAgICAgIH0KICAgIF0KICB9Cn07CnZhciBzZXJ2aWNlVHlwZU1hcCA9IHsKICBjb25zdWx0YXRpb246IHsKICAgIGNvZGluZzogWwogICAgICB7CiAgICAgICAgc3lzdGVtOiAiaHR0cDovL3Nub21lZC5pbmZvL3NjdCIsCiAgICAgICAgY29kZTogIjExNDI5MDA2IiwKICAgICAgICBkaXNwbGF5OiAiQ29uc3VsdGF0aW9uIgogICAgICB9CiAgICBdCiAgfSwKICBlbWVyZ2VuY3lSb29tQWRtaXNzaW9uOiB7CiAgICBjb2Rpbmc6IFsKICAgICAgewogICAgICAgIHN5c3RlbTogImh0dHA6Ly9zbm9tZWQuaW5mby9zY3QiLAogICAgICAgIGNvZGU6ICI1MDg0OTAwMiIsCiAgICAgICAgZGlzcGxheTogIkVtZXJnZW5jeSByb29tIGFkbWlzc2lvbiIKICAgICAgfQogICAgXQogIH0KfTsKLy8gQW5ub3RhdGUgdGhlIENvbW1vbkpTIGV4cG9ydCBuYW1lcyBmb3IgRVNNIGltcG9ydCBpbiBub2RlOgowICYmIChtb2R1bGUuZXhwb3J0cyA9IHsKICBoYW5kbGVyCn0pOwpPYmplY3QuYXNzaWduKGV4cG9ydHMsIG1vZHVsZS5leHBvcnRzKTsK"
      }
    },
    {
      "request": {
        "method": "PUT",
        "url": "$bot-example-data-reference"
      },
      "resource": {
        "resourceType": "Bot",
        "id": "$bot-example-data-id",
        "identifier": [
          {
            "system": "http://example.com",
            "value": "example-data"
          }
        ],
        "name": "example-data",
        "runtimeVersion": "awslambda",
        "sourceCode": {
          "contentType": "text/typescript",
          "url": "urn:uuid:56556a96-88dc-4c49-8bed-4a7f73d69a23"
        },
        "executableCode": {
          "contentType": "text/javascript",
          "url": "urn:uuid:64acdec2-3e9f-45fb-a0ad-f666da7c7234"
        }
      }
    }
  ]
}